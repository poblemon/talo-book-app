/**
 * @license
 * MIT License
 * 
 * Copyright (c) 2022 Uploadcare (hello@uploadcare.com). All rights reserved.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */
var ki=Object.defineProperty;var Li=Object.getPrototypeOf;var Ii=Reflect.get;var Mi=(i,t,e)=>t in i?ki(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var f=(i,t,e)=>Mi(i,typeof t!="symbol"?t+"":t,e);var pt=(i,t,e)=>Ii(Li(i),e,t);var Pi=Object.defineProperty,Ri=(i,t,e)=>t in i?Pi(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Ge=(i,t,e)=>(Ri(i,typeof t!="symbol"?t+"":t,e),e);function Ni(i){let t=e=>{var r;for(let s in e)((r=e[s])==null?void 0:r.constructor)===Object&&(e[s]=t(e[s]));return{...e}};return t(i)}var x=class{constructor(i){i.constructor===Object?this.store=Ni(i):(this._storeIsProxy=!0,this.store=i),this.callbackMap=Object.create(null)}static warn(i,t){console.warn(`Symbiote Data: cannot ${i}. Prop name: `+t)}read(i){return!this._storeIsProxy&&!this.store.hasOwnProperty(i)?(x.warn("read",i),null):this.store[i]}has(i){return this._storeIsProxy?this.store[i]!==void 0:this.store.hasOwnProperty(i)}add(i,t,e=!1){!e&&Object.keys(this.store).includes(i)||(this.store[i]=t,this.notify(i))}pub(i,t){if(!this._storeIsProxy&&!this.store.hasOwnProperty(i)){x.warn("publish",i);return}this.store[i]=t,this.notify(i)}multiPub(i){for(let t in i)this.pub(t,i[t])}notify(i){this.callbackMap[i]&&this.callbackMap[i].forEach(t=>{t(this.store[i])})}sub(i,t,e=!0){return!this._storeIsProxy&&!this.store.hasOwnProperty(i)?(x.warn("subscribe",i),null):(this.callbackMap[i]||(this.callbackMap[i]=new Set),this.callbackMap[i].add(t),e&&t(this.store[i]),{remove:()=>{this.callbackMap[i].delete(t),this.callbackMap[i].size||delete this.callbackMap[i]},callback:t})}static registerCtx(i,t=Symbol()){let e=x.globalStore.get(t);return e?console.warn('State: context UID "'+t+'" already in use'):(e=new x(i),x.globalStore.set(t,e)),e}static deleteCtx(i){x.globalStore.delete(i)}static getCtx(i,t=!0){return x.globalStore.get(i)||(t&&console.warn('State: wrong context UID - "'+i+'"'),null)}};x.globalStore=new Map;var _=Object.freeze({BIND_ATTR:"set",ATTR_BIND_PRFX:"@",EXT_DATA_CTX_PRFX:"*",NAMED_DATA_CTX_SPLTR:"/",CTX_NAME_ATTR:"ctx-name",CTX_OWNER_ATTR:"ctx-owner",CSS_CTX_PROP:"--ctx-name",EL_REF_ATTR:"ref",AUTO_TAG_PRFX:"sym",REPEAT_ATTR:"repeat",REPEAT_ITEM_TAG_ATTR:"repeat-item-tag",SET_LATER_KEY:"__toSetLater__",USE_TPL:"use-template",ROOT_STYLE_ATTR_NAME:"sym-component"}),gt="1234567890QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm",Di=gt.length-1,Ui=class{static generate(i="XXXXXXXXX-XXX"){let t="";for(let e=0;e<i.length;e++)t+=i[e]==="-"?i[e]:gt.charAt(Math.random()*Di);return t}};function bt(i,t,e){let r=!0,s,o=t.split(".");return o.forEach((n,l)=>{l<o.length-1?i=i[n]:s=n}),i?i[s]=e:r=!1,r}function Fi(i){return i.split("-").map((t,e)=>t&&e?t[0].toUpperCase()+t.slice(1):t).join("").split("_").map((t,e)=>t&&e?t.toUpperCase():t).join("")}function zi(i,t){[...i.querySelectorAll(`[${_.REPEAT_ATTR}]`)].forEach(e=>{let r=e.getAttribute(_.REPEAT_ITEM_TAG_ATTR),s;if(r&&(s=window.customElements.get(r)),!s){s=class extends t.BaseComponent{constructor(){super(),r||(this.style.display="contents")}};let n=e.innerHTML;s.template=n,s.reg(r)}for(;e.firstChild;)e.firstChild.remove();let o=e.getAttribute(_.REPEAT_ATTR);t.sub(o,n=>{if(!n){for(;e.firstChild;)e.firstChild.remove();return}let l=[...e.children],a,c=u=>{u.forEach((d,m)=>{if(l[m])if(l[m].set$)setTimeout(()=>{l[m].set$(d)});else for(let g in d)l[m][g]=d[g];else{a||(a=new DocumentFragment);let g=new s;Object.assign(g.init$,d),a.appendChild(g)}}),a&&e.appendChild(a);let h=l.slice(u.length,l.length);for(let d of h)d.remove()};if(n.constructor===Array)c(n);else if(n.constructor===Object){let u=[];for(let h in n){let d=n[h];Object.defineProperty(d,"_KEY_",{value:h,enumerable:!0}),u.push(d)}c(u)}else console.warn("Symbiote repeat data type error:"),console.log(n)}),e.removeAttribute(_.REPEAT_ATTR),e.removeAttribute(_.REPEAT_ITEM_TAG_ATTR)})}var mt="__default__";function Vi(i,t){if(t.shadowRoot)return;let e=[...i.querySelectorAll("slot")];if(!e.length)return;let r={};e.forEach(s=>{let o=s.getAttribute("name")||mt;r[o]={slot:s,fr:document.createDocumentFragment()}}),t.initChildren.forEach(s=>{var o;let n=mt;s instanceof Element&&s.hasAttribute("slot")&&(n=s.getAttribute("slot"),s.removeAttribute("slot")),(o=r[n])==null||o.fr.appendChild(s)}),Object.values(r).forEach(s=>{if(s.fr.childNodes.length)s.slot.parentNode.replaceChild(s.fr,s.slot);else if(s.slot.childNodes.length){let o=document.createDocumentFragment();o.append(...s.slot.childNodes),s.slot.parentNode.replaceChild(o,s.slot)}else s.slot.remove()})}function ji(i,t){[...i.querySelectorAll(`[${_.EL_REF_ATTR}]`)].forEach(e=>{let r=e.getAttribute(_.EL_REF_ATTR);t.ref[r]=e,e.removeAttribute(_.EL_REF_ATTR)})}function Bi(i,t){[...i.querySelectorAll(`[${_.BIND_ATTR}]`)].forEach(e=>{let s=e.getAttribute(_.BIND_ATTR).split(";");[...e.attributes].forEach(o=>{if(o.name.startsWith("-")&&o.value){let n=Fi(o.name.replace("-",""));s.push(n+":"+o.value),e.removeAttribute(o.name)}}),s.forEach(o=>{if(!o)return;let n=o.split(":").map(u=>u.trim()),l=n[0],a;l.indexOf(_.ATTR_BIND_PRFX)===0&&(a=!0,l=l.replace(_.ATTR_BIND_PRFX,""));let c=n[1].split(",").map(u=>u.trim());for(let u of c){let h;u.startsWith("!!")?(h="double",u=u.replace("!!","")):u.startsWith("!")&&(h="single",u=u.replace("!","")),t.sub(u,d=>{h==="double"?d=!!d:h==="single"&&(d=!d),a?(d==null?void 0:d.constructor)===Boolean?d?e.setAttribute(l,""):e.removeAttribute(l):e.setAttribute(l,d):bt(e,l,d)||(e[_.SET_LATER_KEY]||(e[_.SET_LATER_KEY]=Object.create(null)),e[_.SET_LATER_KEY][l]=d)})}}),e.removeAttribute(_.BIND_ATTR)})}var Ee="{{",he="}}",Hi="skip-text";function Xi(i){let t,e=[],r=document.createTreeWalker(i,NodeFilter.SHOW_TEXT,{acceptNode:s=>{var o;return!((o=s.parentElement)!=null&&o.hasAttribute(Hi))&&s.textContent.includes(Ee)&&s.textContent.includes(he)&&1}});for(;t=r.nextNode();)e.push(t);return e}var Ki=function(i,t){Xi(i).forEach(r=>{let s=[],o;for(;r.textContent.includes(he);)r.textContent.startsWith(Ee)?(o=r.textContent.indexOf(he)+he.length,r.splitText(o),s.push(r)):(o=r.textContent.indexOf(Ee),r.splitText(o)),r=r.nextSibling;s.forEach(n=>{let l=n.textContent.replace(Ee,"").replace(he,"");n.textContent="",t.sub(l,a=>{n.textContent=a})})})},Gi=[zi,Vi,ji,Bi,Ki],Ce="'",te='"',Wi=/\\([0-9a-fA-F]{1,6} ?)/g;function qi(i){return(i[0]===te||i[0]===Ce)&&(i[i.length-1]===te||i[i.length-1]===Ce)}function Yi(i){return(i[0]===te||i[0]===Ce)&&(i=i.slice(1)),(i[i.length-1]===te||i[i.length-1]===Ce)&&(i=i.slice(0,-1)),i}function Zi(i){let t="",e="";for(var r=0;r<i.length;r++){let s=i[r+1];i[r]==="\\"&&s==='"'?(t+='\\"',r++):i[r]==='"'&&e!=="\\"?t+='\\"':t+=i[r],e=i[r]}return t}function Qi(i){let t=i;qi(i)&&(t=Yi(t),t=t.replace(Wi,(e,r)=>String.fromCodePoint(parseInt(r.trim(),16))),t=t.replaceAll(`\\
`,"\\n"),t=Zi(t),t=te+t+te);try{return JSON.parse(t)}catch{throw new Error(`Failed to parse CSS property value: ${t}. Original input: ${i}`)}}var _t=0,ee=null,F=null,H=class extends HTMLElement{constructor(){super(),Ge(this,"updateCssData",()=>{var i;this.dropCssDataCache(),(i=this.__boundCssProps)==null||i.forEach(t=>{let e=this.getCssData(this.__extractCssName(t),!0);e!==null&&this.$[t]!==e&&(this.$[t]=e)})}),this.init$=Object.create(null),this.cssInit$=Object.create(null),this.tplProcessors=new Set,this.ref=Object.create(null),this.allSubs=new Set,this.pauseRender=!1,this.renderShadow=!1,this.readyToDestroy=!0,this.processInnerHtml=!1,this.allowCustomTemplate=!1,this.ctxOwner=!1}get BaseComponent(){return H}initCallback(){}__initCallback(){var i;this.__initialized||(this.__initialized=!0,(i=this.initCallback)==null||i.call(this))}render(i,t=this.renderShadow){let e;if((t||this.constructor.__shadowStylesUrl)&&!this.shadowRoot&&this.attachShadow({mode:"open"}),this.allowCustomTemplate){let s=this.getAttribute(_.USE_TPL);if(s){let o=this.getRootNode(),n=(o==null?void 0:o.querySelector(s))||document.querySelector(s);n?i=n.content.cloneNode(!0):console.warn(`Symbiote template "${s}" is not found...`)}}if(this.processInnerHtml)for(let s of this.tplProcessors)s(this,this);if(i||this.constructor.template){if(this.constructor.template&&!this.constructor.__tpl&&(this.constructor.__tpl=document.createElement("template"),this.constructor.__tpl.innerHTML=this.constructor.template),(i==null?void 0:i.constructor)===DocumentFragment)e=i;else if((i==null?void 0:i.constructor)===String){let s=document.createElement("template");s.innerHTML=i,e=s.content.cloneNode(!0)}else this.constructor.__tpl&&(e=this.constructor.__tpl.content.cloneNode(!0));for(let s of this.tplProcessors)s(e,this)}let r=()=>{e&&(t&&this.shadowRoot.appendChild(e)||this.appendChild(e)),this.__initCallback()};if(this.constructor.__shadowStylesUrl){t=!0;let s=document.createElement("link");s.rel="stylesheet",s.href=this.constructor.__shadowStylesUrl,s.onload=r,this.shadowRoot.prepend(s)}else r()}addTemplateProcessor(i){this.tplProcessors.add(i)}get autoCtxName(){return this.__autoCtxName||(this.__autoCtxName=Ui.generate(),this.style.setProperty(_.CSS_CTX_PROP,`'${this.__autoCtxName}'`)),this.__autoCtxName}get cssCtxName(){return this.getCssData(_.CSS_CTX_PROP,!0)}get ctxName(){var i;let t=((i=this.getAttribute(_.CTX_NAME_ATTR))==null?void 0:i.trim())||this.cssCtxName||this.__cachedCtxName||this.autoCtxName;return this.__cachedCtxName=t,t}get localCtx(){return this.__localCtx||(this.__localCtx=x.registerCtx({},this)),this.__localCtx}get nodeCtx(){return x.getCtx(this.ctxName,!1)||x.registerCtx({},this.ctxName)}static __parseProp(i,t){let e,r;if(i.startsWith(_.EXT_DATA_CTX_PRFX))e=t.nodeCtx,r=i.replace(_.EXT_DATA_CTX_PRFX,"");else if(i.includes(_.NAMED_DATA_CTX_SPLTR)){let s=i.split(_.NAMED_DATA_CTX_SPLTR);e=x.getCtx(s[0]),r=s[1]}else e=t.localCtx,r=i;return{ctx:e,name:r}}sub(i,t,e=!0){let r=o=>{this.isConnected&&t(o)},s=H.__parseProp(i,this);s.ctx.has(s.name)?this.allSubs.add(s.ctx.sub(s.name,r,e)):window.setTimeout(()=>{this.allSubs.add(s.ctx.sub(s.name,r,e))})}notify(i){let t=H.__parseProp(i,this);t.ctx.notify(t.name)}has(i){let t=H.__parseProp(i,this);return t.ctx.has(t.name)}add(i,t,e=!1){let r=H.__parseProp(i,this);r.ctx.add(r.name,t,e)}add$(i,t=!1){for(let e in i)this.add(e,i[e],t)}get $(){if(!this.__stateProxy){let i=Object.create(null);this.__stateProxy=new Proxy(i,{set:(t,e,r)=>{let s=H.__parseProp(e,this);return s.ctx.pub(s.name,r),!0},get:(t,e)=>{let r=H.__parseProp(e,this);return r.ctx.read(r.name)}})}return this.__stateProxy}set$(i,t=!1){for(let e in i){let r=i[e];t||![String,Number,Boolean].includes(r==null?void 0:r.constructor)?this.$[e]=r:this.$[e]!==r&&(this.$[e]=r)}}get __ctxOwner(){return this.ctxOwner||this.hasAttribute(_.CTX_OWNER_ATTR)&&this.getAttribute(_.CTX_OWNER_ATTR)!=="false"}__initDataCtx(){let i=this.constructor.__attrDesc;if(i)for(let t of Object.values(i))Object.keys(this.init$).includes(t)||(this.init$[t]="");for(let t in this.init$)if(t.startsWith(_.EXT_DATA_CTX_PRFX))this.nodeCtx.add(t.replace(_.EXT_DATA_CTX_PRFX,""),this.init$[t],this.__ctxOwner);else if(t.includes(_.NAMED_DATA_CTX_SPLTR)){let e=t.split(_.NAMED_DATA_CTX_SPLTR),r=e[0].trim(),s=e[1].trim();if(r&&s){let o=x.getCtx(r,!1);o||(o=x.registerCtx({},r)),o.add(s,this.init$[t])}}else this.localCtx.add(t,this.init$[t]);for(let t in this.cssInit$)this.bindCssData(t,this.cssInit$[t]);this.__dataCtxInitialized=!0}connectedCallback(){var i;if(this.isConnected){if(this.__disconnectTimeout&&window.clearTimeout(this.__disconnectTimeout),!this.connectedOnce){let t=(i=this.getAttribute(_.CTX_NAME_ATTR))==null?void 0:i.trim();if(t&&this.style.setProperty(_.CSS_CTX_PROP,`'${t}'`),this.__initDataCtx(),this[_.SET_LATER_KEY]){for(let e in this[_.SET_LATER_KEY])bt(this,e,this[_.SET_LATER_KEY][e]);delete this[_.SET_LATER_KEY]}this.initChildren=[...this.childNodes];for(let e of Gi)this.addTemplateProcessor(e);if(this.pauseRender)this.__initCallback();else if(this.constructor.__rootStylesLink){let e=this.getRootNode();if(!e)return;if(e==null?void 0:e.querySelector(`link[${_.ROOT_STYLE_ATTR_NAME}="${this.constructor.is}"]`)){this.render();return}let s=this.constructor.__rootStylesLink.cloneNode(!0);s.setAttribute(_.ROOT_STYLE_ATTR_NAME,this.constructor.is),s.onload=()=>{this.render()},e.nodeType===Node.DOCUMENT_NODE?e.head.appendChild(s):e.prepend(s)}else this.render()}this.connectedOnce=!0}}destroyCallback(){}disconnectedCallback(){this.connectedOnce&&(this.dropCssDataCache(),this.readyToDestroy&&(this.__disconnectTimeout&&window.clearTimeout(this.__disconnectTimeout),this.__disconnectTimeout=window.setTimeout(()=>{this.destroyCallback();for(let i of this.allSubs)i.remove(),this.allSubs.delete(i);for(let i of this.tplProcessors)this.tplProcessors.delete(i);F==null||F.delete(this.updateCssData),F!=null&&F.size||(ee==null||ee.disconnect(),ee=null,F=null)},100)))}static reg(i,t=!1){i||(_t++,i=`${_.AUTO_TAG_PRFX}-${_t}`),this.__tag=i;let e=window.customElements.get(i);if(e){!t&&e!==this&&console.warn([`Element with tag name "${i}" already registered.`,`You're trying to override it with another class "${this.name}".`,"This is most likely a mistake.","New element will not be registered."].join(`
`));return}window.customElements.define(i,t?class extends this{}:this)}static get is(){return this.__tag||this.reg(),this.__tag}static bindAttributes(i){this.observedAttributes=Object.keys(i),this.__attrDesc=i}attributeChangedCallback(i,t,e){var r;if(t===e)return;let s=(r=this.constructor.__attrDesc)==null?void 0:r[i];s?this.__dataCtxInitialized?this.$[s]=e:this.init$[s]=e:this[i]=e}getCssData(i,t=!1){if(this.__cssDataCache||(this.__cssDataCache=Object.create(null)),!Object.keys(this.__cssDataCache).includes(i)){this.__computedStyle||(this.__computedStyle=window.getComputedStyle(this));let e=this.__computedStyle.getPropertyValue(i).trim();try{this.__cssDataCache[i]=Qi(e)}catch{!t&&console.warn(`CSS Data error: ${i}`),this.__cssDataCache[i]=null}}return this.__cssDataCache[i]}__extractCssName(i){return i.split("--").map((t,e)=>e===0?"":t).join("--")}__initStyleAttrObserver(){F||(F=new Set),F.add(this.updateCssData),ee||(ee=new MutationObserver(i=>{i[0].type==="attributes"&&F.forEach(t=>{t()})}),ee.observe(document,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style"]}))}bindCssData(i,t=""){this.__boundCssProps||(this.__boundCssProps=new Set),this.__boundCssProps.add(i);let e=this.getCssData(this.__extractCssName(i),!0);e===null&&(e=t),this.add(i,e),this.__initStyleAttrObserver()}dropCssDataCache(){this.__cssDataCache=null,this.__computedStyle=null}defineAccessor(i,t,e){let r="__"+i;this[r]=this[i],Object.defineProperty(this,i,{set:s=>{this[r]=s,e?window.setTimeout(()=>{t==null||t(s)}):t==null||t(s)},get:()=>this[r]}),this[i]=this[r]}static set shadowStyles(i){let t=new Blob([i],{type:"text/css"});this.__shadowStylesUrl=URL.createObjectURL(t)}static set rootStyles(i){if(!this.__rootStylesLink){let t=new Blob([i],{type:"text/css"}),e=URL.createObjectURL(t),r=document.createElement("link");r.href=e,r.rel="stylesheet",this.__rootStylesLink=r}}},We=H;Ge(We,"template");var Ke=class{static _print(i){console.warn(i)}static setDefaultTitle(i){this.defaultTitle=i}static setRoutingMap(i){Object.assign(this.appMap,i);for(let t in this.appMap)!this.defaultRoute&&this.appMap[t].default===!0?this.defaultRoute=t:!this.errorRoute&&this.appMap[t].error===!0&&(this.errorRoute=t)}static set routingEventName(i){this.__routingEventName=i}static get routingEventName(){return this.__routingEventName||"sym-on-route"}static readAddressBar(){let i={route:null,options:{}};return window.location.search.split(this.separator).forEach(e=>{if(e.includes("?"))i.route=e.replace("?","");else if(e.includes("=")){let r=e.split("=");i.options[r[0]]=decodeURI(r[1])}else i.options[e]=!0}),i}static notify(){let i=this.readAddressBar(),t=this.appMap[i.route];if(t&&t.title&&(document.title=t.title),i.route===null&&this.defaultRoute){this.applyRoute(this.defaultRoute);return}else if(!t&&this.errorRoute){this.applyRoute(this.errorRoute);return}else if(!t&&this.defaultRoute){this.applyRoute(this.defaultRoute);return}else if(!t){this._print(`Route "${i.route}" not found...`);return}let e=new CustomEvent(Ke.routingEventName,{detail:{route:i.route,options:Object.assign(t||{},i.options)}});window.dispatchEvent(e)}static reflect(i,t={}){let e=this.appMap[i];if(!e){this._print("Wrong route: "+i);return}let r="?"+i;for(let o in t)t[o]===!0?r+=this.separator+o:r+=this.separator+o+`=${t[o]}`;let s=e.title||this.defaultTitle||"";window.history.pushState(null,s,r),document.title=s}static applyRoute(i,t={}){this.reflect(i,t),this.notify()}static setSeparator(i){this._separator=i}static get separator(){return this._separator||"&"}static createRouterData(i,t){this.setRoutingMap(t);let e=x.registerCtx({route:null,options:null,title:null},i);return window.addEventListener(this.routingEventName,r=>{var s;e.multiPub({route:r.detail.route,options:r.detail.options,title:((s=r.detail.options)==null?void 0:s.title)||this.defaultTitle||""})}),Ke.notify(),this.initPopstateListener(),e}static initPopstateListener(){this.__onPopstate||(this.__onPopstate=()=>{this.notify()},window.addEventListener("popstate",this.__onPopstate))}static removePopstateListener(){window.removeEventListener("popstate",this.__onPopstate),this.__onPopstate=null}};Ke.appMap=Object.create(null);var yt="idb-store-ready",Ji="symbiote-db",er="symbiote-idb-update_",tr=class{_notifyWhenReady(i=null){window.dispatchEvent(new CustomEvent(yt,{detail:{dbName:this.name,storeName:this.storeName,event:i}}))}get _updEventName(){return er+this.name}_getUpdateEvent(i){return new CustomEvent(this._updEventName,{detail:{key:this.name,newValue:i}})}_notifySubscribers(i){window.localStorage.removeItem(this.name),window.localStorage.setItem(this.name,i),window.dispatchEvent(this._getUpdateEvent(i))}constructor(i,t){this.name=i,this.storeName=t,this.version=1,this.request=window.indexedDB.open(this.name,this.version),this.request.onupgradeneeded=e=>{this.db=e.target.result,this.objStore=this.db.createObjectStore(t,{keyPath:"_key"}),this.objStore.transaction.oncomplete=r=>{this._notifyWhenReady(r)}},this.request.onsuccess=e=>{this.db=e.target.result,this._notifyWhenReady(e)},this.request.onerror=e=>{console.error(e)},this._subscriptionsMap={},this._updateHandler=e=>{e.key===this.name&&this._subscriptionsMap[e.newValue]&&this._subscriptionsMap[e.newValue].forEach(async s=>{s(await this.read(e.newValue))})},this._localUpdateHandler=e=>{this._updateHandler(e.detail)},window.addEventListener("storage",this._updateHandler),window.addEventListener(this._updEventName,this._localUpdateHandler)}read(i){let e=this.db.transaction(this.storeName,"readwrite").objectStore(this.storeName).get(i);return new Promise((r,s)=>{e.onsuccess=o=>{var n;(n=o.target.result)!=null&&n._value?r(o.target.result._value):(r(null),console.warn(`IDB: cannot read "${i}"`))},e.onerror=o=>{s(o)}})}write(i,t,e=!1){let r={_key:i,_value:t},o=this.db.transaction(this.storeName,"readwrite").objectStore(this.storeName).put(r);return new Promise((n,l)=>{o.onsuccess=a=>{e||this._notifySubscribers(i),n(a.target.result)},o.onerror=a=>{l(a)}})}delete(i,t=!1){let r=this.db.transaction(this.storeName,"readwrite").objectStore(this.storeName).delete(i);return new Promise((s,o)=>{r.onsuccess=n=>{t||this._notifySubscribers(i),s(n)},r.onerror=n=>{o(n)}})}getAll(){let t=this.db.transaction(this.storeName,"readwrite").objectStore(this.storeName).getAll();return new Promise((e,r)=>{t.onsuccess=s=>{let o=s.target.result;e(o.map(n=>n._value))},t.onerror=s=>{r(s)}})}subscribe(i,t){this._subscriptionsMap[i]||(this._subscriptionsMap[i]=new Set);let e=this._subscriptionsMap[i];return e.add(t),{remove:()=>{e.delete(t),e.size||delete this._subscriptionsMap[i]}}}stop(){window.removeEventListener("storage",this._updateHandler),this._subscriptionsMap=null,vt.clear(this.name)}},vt=class{static get readyEventName(){return yt}static open(i=Ji,t="store"){let e=i+"/"+t;return this._reg[e]||(this._reg[e]=new tr(i,t)),this._reg[e]}static clear(i){window.indexedDB.deleteDatabase(i);for(let t in this._reg)t.split("/")[0]===i&&delete this._reg[t]}};Ge(vt,"_reg",Object.create(null));var wt=i=>{if(typeof i!="string"||!i)return"";let t=i.trim();return t.startsWith("-/")?t=t.slice(2):t.startsWith("/")&&(t=t.slice(1)),t.endsWith("/")&&(t=t.slice(0,t.length-1)),t},Te=(...i)=>i.filter(t=>typeof t=="string"&&t).map(t=>wt(t)).join("/-/"),z=(...i)=>{let t=Te(...i);return t?`-/${t}/`:""};function Ae(i){let t=new URL(i),e=t.pathname+t.search+t.hash,r=e.lastIndexOf("http"),s=e.lastIndexOf("/"),o="";return r>=0?o=e.slice(r):s>=0&&(o=e.slice(s+1)),o}function Se(i){let t=new URL(i),{pathname:e}=t,r=e.indexOf("/"),s=e.indexOf("/",r+1);return e.substring(r+1,s)}function qe(i){let t=Et(i),e=new URL(t),r=e.pathname.indexOf("/-/");return r===-1?"":e.pathname.substring(r).slice(1)}function xt(i){return qe(i).split("/-/").filter(Boolean).map(e=>wt(e))}function Et(i){let t=new URL(i),e=Ae(i),r=Ct(e)?Tt(e).pathname:e;return t.pathname=t.pathname.replace(r,""),t.search="",t.hash="",t.toString()}function Ct(i){return i.startsWith("http")}function Tt(i){let t=new URL(i);return{pathname:t.origin+t.pathname||"",search:t.search||"",hash:t.hash||""}}var V=(i,t,e)=>{let r=new URL(Et(i));if(e=e||Ae(i),r.pathname.startsWith("//")&&(r.pathname=r.pathname.replace("//","/")),Ct(e)){let s=Tt(e);r.pathname=r.pathname+(t||"")+(s.pathname||""),r.search=s.search,r.hash=s.hash}else r.pathname=r.pathname+(t||"")+(e||"");return r.toString()},Ye=(i,t)=>{let e=new URL(i);return e.pathname=t+"/",e.toString()};var Ze=(i,t=",")=>i.trim().split(t).map(e=>e.trim()).filter(e=>e.length>0);var L=Object.freeze({brightness:0,exposure:0,gamma:100,contrast:0,saturation:0,vibrance:0,warmth:0,enhance:0,filter:0,rotate:0,mirror:!1,flip:!1,crop:void 0}),St=["enhance","brightness","exposure","gamma","contrast","saturation","vibrance","warmth","filter","mirror","flip","rotate","crop"];function ir(i,t){if(typeof t=="number"){let e=t;return L[i]!==e?`${i}/${e}`:""}if(typeof t=="boolean"){let e=t;return L[i]!==e?`${i}`:""}if(i==="filter"&&t){let{name:e,amount:r}=t;return L.filter===r?"":`${i}/${e}/${r}`}if(i==="crop"&&t){let{dimensions:e,coords:r}=t;return`${i}/${e.join("x")}/${r.join(",")}`}return""}function X(i){return Te(...St.filter(t=>typeof i[t]!="undefined"&&i[t]!==null).map(t=>{let e=i[t];return ir(t,e)}).filter(t=>!!t))}var $e=Te("format/auto","progressive/yes"),j=([i])=>typeof i!="undefined"?Number(i):void 0,At=()=>!0,rr=([i,t])=>({name:i,amount:typeof t!="undefined"?Number(t):100}),sr=([i,t])=>{if(!/\d+x\d+/.test(i)||!/\d+,\d+/.test(t))throw new Error("Crop by aspect ratio, percentage or alignment shortcuts is not supported.");return{dimensions:Ze(i,"x").map(Number),coords:Ze(t).map(Number)}},or=Object.freeze({enhance:j,brightness:j,exposure:j,gamma:j,contrast:j,saturation:j,vibrance:j,warmth:j,filter:rr,mirror:At,flip:At,rotate:j,crop:sr});function $t(i){let t={};for(let e of i){let[r,...s]=e.split("/");if(!St.includes(r))continue;let o=r,n=or[o];try{let l=n(s);t[o]=l}catch(l){console.warn([`Failed to parse URL operation "${e}". It will be ignored.`,l instanceof Error?`Error message: "${l.message}"`:l,"If you need this functionality, please feel free to open an issue at https://github.com/uploadcare/blocks/issues/new"].join(`
`))}}return t}var y=Object.freeze({CROP:"crop",TUNING:"tuning",FILTERS:"filters"}),$=[y.CROP,y.TUNING,y.FILTERS],Ot=["brightness","exposure","gamma","contrast","saturation","vibrance","warmth","enhance"],kt=["adaris","briaril","calarel","carris","cynarel","cyren","elmet","elonni","enzana","erydark","fenralan","ferand","galen","gavin","gethriel","iorill","iothari","iselva","jadis","lavra","misiara","namala","nerion","nethari","pamaya","sarnar","sedis","sewen","sorahel","sorlen","tarian","thellassan","varriel","varven","vevera","virkas","yedis","yllara","zatvel","zevcen"],Lt=["rotate","mirror","flip"],R=Object.freeze({brightness:{zero:L.brightness,range:[-100,100],keypointsNumber:2},exposure:{zero:L.exposure,range:[-500,500],keypointsNumber:2},gamma:{zero:L.gamma,range:[0,1e3],keypointsNumber:2},contrast:{zero:L.contrast,range:[-100,500],keypointsNumber:2},saturation:{zero:L.saturation,range:[-100,500],keypointsNumber:1},vibrance:{zero:L.vibrance,range:[-100,500],keypointsNumber:1},warmth:{zero:L.warmth,range:[-100,100],keypointsNumber:1},enhance:{zero:L.enhance,range:[0,100],keypointsNumber:1},filter:{zero:L.filter,range:[0,100],keypointsNumber:1}});var Y=i=>i?i.split(",").map(t=>t.trim()).filter(Boolean):[],Z=i=>i?i.join(","):"";var nr="https://ucarecdn.com",lr="https://upload.uploadcare.com",ar="https://social.uploadcare.com",M={pubkey:"",multiple:!0,multipleMin:0,multipleMax:Number.MAX_SAFE_INTEGER,confirmUpload:!1,imgOnly:!1,accept:"",externalSourcesPreferredTypes:"",externalSourcesEmbedCss:"",store:"auto",cameraMirror:!1,cameraCapture:"",sourceList:"local, url, camera, dropbox, gdrive",topLevelOrigin:"",cloudImageEditorTabs:Z($),maxLocalFileSizeBytes:0,thumbSize:76,showEmptyList:!1,useLocalImageEditor:!1,useCloudImageEditor:!0,removeCopyright:!1,cropPreset:"",imageShrink:"",modalScrollLock:!0,modalBackdropStrokes:!1,sourceListWrap:!0,remoteTabSessionKey:"",cdnCname:nr,baseUrl:lr,socialBaseUrl:ar,secureSignature:"",secureExpire:"",secureDeliveryProxy:"",retryThrottledRequestMaxTimes:10,retryNetworkErrorMaxTimes:3,multipartMinFileSize:26214400,multipartChunkSize:5242880,maxConcurrentRequests:10,multipartMaxConcurrentRequests:4,multipartMaxAttempts:3,checkForUrlDuplicates:!1,saveUrlForRecurrentUploads:!1,groupOutput:!1,userAgentIntegration:"",debug:!1,metadata:null,localeName:"en",localeDefinitionOverride:null,secureUploadsExpireThreshold:10*60*1e3,secureUploadsSignatureResolver:null,secureDeliveryProxyUrlResolver:null,iconHrefResolver:null,fileValidators:[],collectionValidators:[],cameraModes:"photo, video",defaultCameraMode:null,enableAudioRecording:!0,enableVideoRecording:null,maxVideoRecordingDuration:null,mediaRecorderOptions:null,filesViewMode:"list",gridShowFileNames:!1,cloudImageEditorAutoOpen:!1,cloudImageEditorMaskHref:null,testMode:!1};var us=Object.freeze({FILE_ADDED:"file-added",FILE_REMOVED:"file-removed",FILE_UPLOAD_START:"file-upload-start",FILE_UPLOAD_PROGRESS:"file-upload-progress",FILE_UPLOAD_SUCCESS:"file-upload-success",FILE_UPLOAD_FAILED:"file-upload-failed",FILE_URL_CHANGED:"file-url-changed",MODAL_OPEN:"modal-open",MODAL_CLOSE:"modal-close",DONE_CLICK:"done-click",UPLOAD_CLICK:"upload-click",ACTIVITY_CHANGE:"activity-change",COMMON_UPLOAD_START:"common-upload-start",COMMON_UPLOAD_PROGRESS:"common-upload-progress",COMMON_UPLOAD_SUCCESS:"common-upload-success",COMMON_UPLOAD_FAILED:"common-upload-failed",CHANGE:"change",GROUP_CREATED:"group-created"}),Oe=class{constructor(t){f(this,"_timeoutStore",new Map);f(this,"_targets",new Set);f(this,"_debugPrint",null);this._debugPrint=t}bindTarget(t){this._targets.add(t)}unbindTarget(t){this._targets.delete(t)}_dispatch(t,e){var r;for(let s of this._targets)s.dispatchEvent(new CustomEvent(t,{detail:e}));(r=this._debugPrint)==null||r.call(this,()=>{let s=e&&typeof e=="object"?{...e}:e;return[`event "${t}"`,s]})}emit(t,e,{debounce:r}={}){if(typeof r!="number"&&!r){this._dispatch(t,typeof e=="function"?e():e);return}this._timeoutStore.has(t)&&window.clearTimeout(this._timeoutStore.get(t));let s=typeof r=="number"?r:20,o=window.setTimeout(()=>{this._dispatch(t,typeof e=="function"?e():e),this._timeoutStore.delete(t)},s);this._timeoutStore.set(t,o)}};function C(i,t){let e,r=(...s)=>{clearTimeout(e),e=setTimeout(()=>i(...s),t)};return r.cancel=()=>{clearTimeout(e)},r}var It="--uploadcare-blocks-window-height",Q=class{static registerClient(t){this.clientsRegistry.size===0&&this.attachTracker(),this.clientsRegistry.add(t)}static unregisterClient(t){this.clientsRegistry.delete(t),this.clientsRegistry.size===0&&this.detachTracker()}static attachTracker(){window.addEventListener("resize",this.flush,{passive:!0,capture:!0}),this.flush()}static detachTracker(){window.removeEventListener("resize",this.flush,{capture:!0}),document.documentElement.style.removeProperty(It)}};f(Q,"clientsRegistry",new Set),f(Q,"flush",C(()=>{document.documentElement.style.setProperty(It,`${window.innerHeight}px`)},100));var Mt=i=>{var r;let t=new Intl.Locale(i),e="ltr";return typeof t.getTextInfo=="function"&&t.getTextInfo().direction?e=t.getTextInfo().direction:"textInfo"in t&&((r=t.textInfo)!=null&&r.direction)&&(e=t.textInfo.direction),e};var Pt=(i,t)=>new Intl.PluralRules(i).select(t);var cr=i=>i,Qe="{{",Nt="}}",Rt="plural:";function Je(i,t,e={}){var n;let{openToken:r=Qe,closeToken:s=Nt,transform:o=cr}=e;for(let l in t){let a=(n=t[l])==null?void 0:n.toString();i=i.replaceAll(r+l+s,typeof a=="string"?o(a):a)}return i}function Dt(i){let t=[],e=i.indexOf(Qe);for(;e!==-1;){let r=i.indexOf(Nt,e),s=i.substring(e+2,r);if(s.startsWith(Rt)){let o=i.substring(e+2,r).replace(Rt,""),n=o.substring(0,o.indexOf("(")),l=o.substring(o.indexOf("(")+1,o.indexOf(")"));t.push({variable:s,pluralKey:n,countVariable:l})}e=i.indexOf(Qe,r)}return t}var Ut=({element:i,attribute:t,onSuccess:e,onTimeout:r,timeout:s=300})=>{let o=i.getAttribute(t);if(o!==null){e(o);return}let n=new MutationObserver(c=>{let u=c[c.length-1];a(u)});n.observe(i,{attributes:!0,attributeFilter:[t]});let l=setTimeout(()=>{n.disconnect(),r()},s),a=c=>{let u=i.getAttribute(t);c.type==="attributes"&&c.attributeName===t&&u!==null&&(clearTimeout(l),n.disconnect(),e(u))}};var Ft=()=>({});var ue={"locale-id":"en","social-source-lang":"en","upload-file":"Upload file","upload-files":"Upload files","choose-file":"Choose file","choose-files":"Choose files","drop-files-here":"Drop files here","select-file-source":"Select file source",selected:"Selected",upload:"Upload","add-more":"Add more",cancel:"Cancel","start-from-cancel":"Cancel",clear:"Clear","camera-shot":"Shot","upload-url":"Import","upload-url-placeholder":"Paste link here","edit-image":"Edit image","edit-detail":"Details",back:"Back",done:"Done",ok:"Ok","remove-from-list":"Remove",no:"No",yes:"Yes","confirm-your-action":"Confirm your action","are-you-sure":"Are you sure?","selected-count":"{{count}} of {{total}} selected","select-all":"Select all","deselect-all":"Deselect all","upload-error":"Upload error","validation-error":"Validation error","no-files":"No files selected",browse:"Browse","not-uploaded-yet":"Not uploaded yet...",file__one:"file",file__other:"files",error__one:"error",error__other:"errors","header-uploading":"Uploading {{count}} {{plural:file(count)}}","header-failed":"{{count}} {{plural:error(count)}}","header-succeed":"{{count}} {{plural:file(count)}} uploaded","header-total":"{{count}} {{plural:file(count)}} selected","src-type-local":"From device","src-type-from-url":"From link","src-type-camera":"Camera","src-type-mobile-video-camera":"Video","src-type-mobile-photo-camera":"Photo","src-type-draw":"Draw","src-type-facebook":"Facebook","src-type-dropbox":"Dropbox","src-type-gdrive":"Google Drive","src-type-ngdrive":"Google Drive","src-type-gphotos":"Google Photos","src-type-flickr":"Flickr","src-type-vk":"VK","src-type-evernote":"Evernote","src-type-box":"Box","src-type-onedrive":"Onedrive","src-type-huddle":"Huddle","src-type-other":"Other","caption-from-url":"Import from link","caption-camera":"Camera","caption-draw":"Draw","caption-edit-file":"Edit file","file-no-name":"No name...","toggle-fullscreen":"Toggle fullscreen","toggle-guides":"Toggle guides",rotate:"Rotate","flip-vertical":"Flip vertical","flip-horizontal":"Flip horizontal",apply:"Apply",brightness:"Brightness",contrast:"Contrast",saturation:"Saturation",exposure:"Exposure",gamma:"Gamma",vibrance:"Vibrance",warmth:"Warmth",enhance:"Enhance",original:"Original",resize:"Resize image",crop:"Crop","select-color":"Select color",text:"Text",draw:"Draw","cancel-edit":"Cancel edit","tab-view":"Preview","tab-details":"Details","file-name":"Name","file-size":"Size","cdn-url":"CDN URL","file-size-unknown":"Unknown","camera-permissions-denied":"Camera access denied","camera-permissions-prompt":"Please allow access to the camera","camera-permissions-request":"Request access","files-count-limit-error-title":"Files count limit overflow","files-count-limit-error-too-few":"You\u2019ve chosen {{total}} {{plural:file(total)}}. At least {{min}} {{plural:file(min)}} required.","files-count-limit-error-too-many":"You\u2019ve chosen too many files. {{max}} {{plural:file(max)}} is maximum.","files-max-size-limit-error":"File is too big. Max file size is {{maxFileSize}}.","has-validation-errors":"File validation error occurred. Please, check your files before upload.","images-only-accepted":"Only image files are accepted.","file-type-not-allowed":"Uploading of these file types is not allowed.","some-files-were-not-uploaded":"Some files were not uploaded.","file-item-edit-button":"Edit","file-item-remove-button":"Remove","a11y-editor-tab-filters":"Filters","a11y-editor-tab-tuning":"Tuning","a11y-editor-tab-crop":"Crop","a11y-activity-header-button-close":"Close",flip:"Flip",mirror:"Mirror","a11y-cloud-editor-apply-filter":"Apply {{name}} filter","a11y-cloud-editor-apply-crop":"Apply {{name}} operation","a11y-cloud-editor-apply-tuning":"Apply {{name}} tuning",finished:"Finished",failed:"Failed",uploading:"Uploading",idle:"Idle","a11y-file-item-status":"File {{fileName}} in status {{status}}","waiting-for":"Waiting for {{source}}",queued:"Queued"};var ke=new Map,et=new Map,zt=(i,t)=>{ke.has(i)&&console.log(`Locale ${i} is already defined. Overwriting...`),ke.set(i,{...ue,...t})},hr=(i,t)=>{et.set(i,t)},ur=(i,t)=>{typeof t=="function"?hr(i,t):zt(i,t)},Vt=async i=>{if(!ke.has(i)){if(!et.has(i))throw new Error(`Locale ${i} is not defined`);let e=await et.get(i)();zt(i,e)}return ke.get(i)};ur("en",ue);var P=i=>`*l10n/${i}`,dr="en",Le=class{constructor(t){f(this,"_blockInstance",null);f(this,"_localeName","");f(this,"_callbacks",new Set);f(this,"_boundBlocks",new Map);this._blockInstance=t;for(let[e,r]of Object.entries(ue)){let s=this._blockInstance.has(P(e))?!this._blockInstance.$[P(e)]:!0;this._blockInstance.add(P(e),r,s)}setTimeout(()=>{t.subConfigValue("localeName",async e=>{var o;if(!this._blockInstance||!e)return;this._localeName=e;let r=await Vt(e);if(e!==dr&&this._localeName!==e)return;let s=(o=this._blockInstance.cfg.localeDefinitionOverride)==null?void 0:o[e];for(let[n,l]of Object.entries(r)){let a=s==null?void 0:s[n];this._blockInstance.add(P(n),a!=null?a:l,!0);for(let c of this._callbacks)c()}}),t.subConfigValue("localeDefinitionOverride",e=>{var s;if(!e)return;let r=e[this._localeName];if(r)for(let[o,n]of Object.entries(r)){(s=this._blockInstance)==null||s.add(P(o),n,!0);for(let l of this._callbacks)l()}})})}onLocaleChange(t){let e=C(t,0);return this._callbacks.add(e),()=>{this._callbacks.delete(e)}}bindL10n(t,e,r){var o,n,l;t.$[e]=r(),this._boundBlocks.has(t)||this._boundBlocks.set(t,new Map),(n=(o=this._boundBlocks.get(t))==null?void 0:o.get(e))==null||n();let s=this.onLocaleChange(()=>{t.$[e]=r()});(l=this._boundBlocks.get(t))==null||l.set(e,s)}destroyL10nBindings(t){let e=this._boundBlocks.get(t);if(e){for(let r of e.values())r();this._boundBlocks.delete(t)}}destroy(){this._callbacks.clear()}};function jt(i,t){[...i.querySelectorAll("[l10n]")].forEach(e=>{let r=e.getAttribute("l10n");if(!r)return;let s=r.split(";");for(let o of s)o&&fr(e,o,t)})}var fr=(i,t,e)=>{let r="textContent",s=!1;if(t.includes(":")){let l=t.split(":");r=l[0],t=l[1],r.startsWith("@")&&(r=r.slice(1),s=!0)}let o=t;e.has(o)&&e.sub(o,l=>{if(!l)return;e.l10nProcessorSubs.has(o)||e.l10nProcessorSubs.set(o,new Set);let a=e.l10nProcessorSubs.get(o);a==null||a.forEach(h=>{h.remove(),a.delete(h),e.allSubs.delete(h)});let c=P(l).replace("*","");e.nodeCtx.has(c)||e.nodeCtx.add(c,l);let u=e.nodeCtx.sub(c,()=>{i[r]=e.l10n(l)});a==null||a.add(u),e.allSubs.add(u),i.removeAttribute("l10n")});let n=P(t);e.has(n)||e.add(n,""),e.sub(n,()=>{t=t,s?i.setAttribute(r,e.l10n(t)):i[r]=e.l10n(t)}),i.removeAttribute("l10n")};var T=i=>`*cfg/${i}`;var pr={button:["toolbar"],checkbox:["toolbar"],menuitem:["menu","menubar"],option:["listbox"],tab:["tablist"]};function de(i,t){t.tabIndex=0,t.focus(),i.tabIndex=-1}function tt(i){let t=i.role||i.type||i.tagName;if(!t)return null;let e=pr[t.toLowerCase()];if(!e)return null;for(let r of e){let s=i.closest(`[role=${r}]`);if(s)return s}}function it(i,t){return t.role==="toolbar"?mr(t):t.querySelectorAll(`[role=${i.role}]`)}function mr(i){return[...i.querySelectorAll("*")].filter(e=>e.role==="button"||e.type==="button"||e.role==="checkbox"||e.type==="checkbox")}function _r(i){let t=i.getAttribute("aria-orientation");if(t==="vertical")return!1;if(t==="horizontal")return!0;let e=i.role;return e==="menubar"||e==="tablist"||e==="toolbar"}function Bt(i){return t=>{let e=!1,r=(i==null?void 0:i.searchDelayMs)||300,s=0,o="";function n(h){let d=tt(h.target);if(!d){l();return}let m=it(h.target,d),g=Array.from(m).indexOf(h.target),A="ArrowDown",S="ArrowUp";if(_r(d)&&(t.document.dir==="rtl"?(A="ArrowLeft",S="ArrowRight"):(A="ArrowRight",S="ArrowLeft")),h.key===A)h.preventDefault(),de(h.target,m[g+1]||m[0]);else if(h.key===S)h.preventDefault(),de(h.target,m[g-1]||m[m.length-1]);else if(h.key==="Home")h.preventDefault(),de(h.target,m[0]);else if(h.key==="End")h.preventDefault(),de(h.target,m[m.length-1]);else if(h.key.length===1&&d.role!=="tablist"){let k=Date.now();k-s<=r?o+=h.key.toLowerCase():o=h.key.toLowerCase(),s=k;let q=Array.from(m).find(Oi=>{var ut,dt,ft;return(ft=(dt=(ut=Oi.textContent)==null?void 0:ut.trim())==null?void 0:dt.toLowerCase())==null?void 0:ft.startsWith(o)});q&&(h.preventDefault(),de(h.target,q))}}function l(){e=!1,t.removeEventListener("keydown",n)}function a(h){let d=tt(h.target);if(d){e||(e=!0,t.addEventListener("keydown",n));let m=it(h.target,d);for(let g of m)g!==h.target&&g.setAttribute("tabindex",-1)}else e&&l()}function c(h){(!h.relatedTarget||h.relatedTarget===t.document)&&l()}function u(h){let d=tt(h.target);if(d){let m=it(h.target,d);for(let g of m)g!==h.target&&g.setAttribute("tabindex",-1);h.target.setAttribute("tabindex",0)}}return t.addEventListener("click",u),t.addEventListener("focusin",a),t.addEventListener("focusout",c),()=>{l(),t.removeEventListener("click",u),t.removeEventListener("focusin",a),t.removeEventListener("focusout",c)}}}function Ht(){return i=>{let t,e;function r(o){if(o.target.getAttribute("aria-hidden")==="true"){t=o.target,t.setAttribute("aria-hidden","false"),e=t.hidden,e&&(t.hidden=!1);let n=o.target.querySelector('a, button, select, textarea, input:not([type=radio]), [type=radio]:checked, [tabindex]:not([tabindex="-1"])');n&&(n.tabIndex=0)}}function s(o){t&&t.contains(o.target)&&(!o.relatedTarget||!t.contains(o.relatedTarget))&&(o.target.tabIndex=-1,t.setAttribute("aria-hidden","true"),e&&(t.hidden=!0),t=null)}return i.addEventListener("keyuxJump",r),i.addEventListener("focusout",s),()=>{i.removeEventListener("keyuxJump",r),i.removeEventListener("focusout",s)}}}function Xt(){return i=>{let t=[];function e(a){let c=i.document.activeElement;c&&c!==i.document.body&&t.push(new WeakRef(c)),a.focus({focusVisible:!0})}function r(){let a=t.pop();if(!a){i.document.activeElement.blur();return}let c=a.deref();c&&c.isConnected?c.focus():r()}let s=0,o;function n(a){clearInterval(o);let c=a.getAttribute("aria-controls");o=setInterval(()=>{if(s++>50){clearInterval(o);return}let u=i.document.getElementById(c);if(u){let h=u.querySelector('a, button, select, textarea, input:not([type=radio]), [type=radio]:checked, [tabindex]:not([tabindex="-1"])');h&&(clearInterval(o),u.dispatchEvent(new i.CustomEvent("keyuxJump",{bubbles:!0})),e(h))}},50)}function l(a){a.target.getAttribute("aria-controls")&&a.key==="Enter"&&n(a.target),a.key==="Escape"&&r()}return i.addEventListener("keydown",l),()=>{i.removeEventListener("keydown",l)}}}function Kt(i){let t,e=i.split(" "),r;function s(l){l.key==="Enter"&&(l.target.tagName==="BUTTON"||l.target.tagName==="A")&&(o(),l.target.classList.add(...e),t=l.target,r=l.target)}function o(){t&&t.classList.remove(...e),r=null}function n(l){l.clientX===0&&l.clientY===0&&r!==l.target&&(o(),l.target.classList.add(...e),t=l.target)}return l=>(l.addEventListener("click",n),l.addEventListener("keydown",s),l.addEventListener("keyup",o),()=>{l.removeEventListener("click",n),l.removeEventListener("keydown",s),l.removeEventListener("keyup",o)})}function Gt(i,t){let e=t.map(r=>r(i));return()=>{e.forEach(r=>r())}}var rt=class{constructor(){f(this,"_listeners",new Map);f(this,"_scope",[])}addEventListener(t,e){let r=s=>{let o=s.target;o&&this._scope.some(n=>n===s.target||n.contains(o))&&e(s)};this._listeners.set(e,r),window.addEventListener(t,r)}removeEventListener(t,e){let r=this._listeners.get(e);r&&window.removeEventListener(t,r),this._listeners.delete(e)}get CustomEvent(){return window.CustomEvent}get document(){return window.document}get navigator(){return window.navigator}registerScope(t){this._scope.push(t)}destroy(){this._scope=[],this._listeners.forEach((t,e)=>{window.removeEventListener("keydown",t),window.removeEventListener("keyup",t),this._listeners.delete(e)})}},Ie=class{constructor(){f(this,"_destroyKeyUX");f(this,"_scopedWindow");this._scopedWindow=new rt,this._destroyKeyUX=Gt(this._scopedWindow,[Bt(),Kt("is-pressed"),Xt(),Ht()])}registerBlock(t){this._scopedWindow.registerScope(t)}destroy(){var t;(t=this._destroyKeyUX)==null||t.call(this),this._scopedWindow.destroy()}};var ie=Object.freeze({ADD:"modal:add",DELETE:"modal:delete",OPEN:"modal:open",CLOSE:"modal:close",CLOSE_ALL:"modal:closeAll",DESTROY:"modal:destroy"}),Me=class{constructor(t){f(this,"_modals",new Map);f(this,"_activeModals",new Set);f(this,"_subscribers",new Map);this._block=t}_debugPrint(...t){this._block.debugPrint("[modal-manager]",...t)}registerModal(t,e){this._modals.set(t,e),this._notify(ie.ADD,{id:t,modal:e})}deleteModal(t){if(!this._modals.has(t))return!1;let e=this._modals.get(t);return this._modals.delete(t),this._activeModals.delete(t),this._notify(ie.DELETE,{id:t,modal:e}),!0}open(t){if(!this._modals.has(t))return this._debugPrint(`Modal with ID "${t}" not found`),!1;let e=this._modals.get(t);return this._activeModals.add(t),this._notify(ie.OPEN,{modal:e,id:t}),!0}close(t){if(!this._modals.has(t)||!this._activeModals.has(t))return this._debugPrint(`Modal with ID "${t}" not found or not active`),!1;let e=this._modals.get(t);return this._activeModals.delete(t),this._notify(ie.CLOSE,{id:t,modal:e}),!0}toggle(t){return this._modals.has(t)?this._activeModals.has(t)?this.close(t):this.open(t):(this._debugPrint(`Modal with ID "${t}" not found`),!1)}get hasActiveModals(){return this._activeModals.size>0}back(){if(this._activeModals.size===0)return this._debugPrint("No active modals to go back from"),!1;let t=Array.from(this._activeModals).pop();return this.close(t)}closeAll(){let t=this._activeModals.size;return this._activeModals.clear(),this._notify(ie.CLOSE_ALL,{}),t}subscribe(t,e){var r;return this._subscribers.has(t)||this._subscribers.set(t,new Set),(r=this._subscribers.get(t))==null||r.add(e),()=>this.unsubscribe(t,e)}unsubscribe(t,e){var r;this._subscribers.has(t)&&((r=this._subscribers.get(t))==null||r.delete(e))}_notify(t,e){var r;if(this._subscribers.has(t))for(let s of(r=this._subscribers.get(t))!=null?r:new Set)try{s(e)}catch(o){this._debugPrint("Error in modal subscriber:",o)}}destroy(){this.closeAll(),this._modals.clear(),this._subscribers.clear(),this._notify(ie.DESTROY,{})}};function Wt(i,t){let e=i.querySelectorAll("[data-testid]");if(e.length===0)return;let r=new WeakMap;for(let s of e){let o=s.getAttribute("data-testid");o&&r.set(s,o)}t.subConfigValue("testMode",s=>{if(!s){for(let n of e)n.removeAttribute("data-testid");return}let o=t.testId;for(let n of e){let l=r.get(n);l&&n.setAttribute("data-testid",`${o}--${l}`)}})}var gr="uc-",b=class extends We{constructor(){super();f(this,"requireCtxName",!1);f(this,"activityType",null);f(this,"init$",Ft());this.l10nProcessorSubs=new Map,this.addTemplateProcessor(jt),this.addTemplateProcessor(Wt)}l10n(e,r={}){if(!e)return"";let s=this.$[P(e)]||e,o=Dt(s);for(let l of o)r[l.variable]=this.pluralize(l.pluralKey,Number(r[l.countVariable]));return Je(s,r)}pluralize(e,r){let s=this.l10n("locale-id")||"en",o=Pt(s,r);return this.l10n(`${e}__${o}`)}bindL10n(e,r){var s;(s=this.localeManager)==null||s.bindL10n(this,e,r)}emit(e,r,s){let o=this.has("*eventEmitter")&&this.$["*eventEmitter"];o&&o.emit(e,r,s)}hasBlockInCtx(e){for(let r of this.blocksRegistry)if(e(r))return!0;return!1}setOrAddState(e,r){this.add$({[e]:r},!0)}connectedCallback(){this.constructor.styleAttrs.forEach(r=>{this.setAttribute(r,"")}),this.hasAttribute("retpl")&&(this.constructor.template=null,this.processInnerHtml=!0),this.requireCtxName?Ut({element:this,attribute:"ctx-name",onSuccess:()=>{super.connectedCallback()},onTimeout:()=>{console.error("Attribute `ctx-name` is required and it is not set.")}}):super.connectedCallback(),Q.registerClient(this)}disconnectedCallback(){super.disconnectedCallback(),Q.unregisterClient(this)}initCallback(){this.has("*blocksRegistry")||this.add("*blocksRegistry",new Set),this.$["*blocksRegistry"].add(this),this.has("*eventEmitter")||this.add("*eventEmitter",new Oe(this.debugPrint.bind(this))),this.has("*localeManager")||this.add("*localeManager",new Le(this)),this.has("*a11y")||this.add("*a11y",new Ie),this.has("*modalManager")||this.add("*modalManager",new Me(this)),this.sub(P("locale-id"),r=>{let s=Mt(r);this.style.direction=s==="ltr"?"":s}),this.subConfigValue("testMode",r=>{if(!r||!this.testId){this.removeAttribute("data-testid");return}this.setAttribute("data-testid",this.testId)})}get testId(){return window.customElements.getName(this.constructor)}get modalManager(){return this.has("*modalManager")&&this.$["*modalManager"]}get localeManager(){return this.has("*localeManager")?this.$["*localeManager"]:null}get a11y(){return this.has("*a11y")?this.$["*a11y"]:null}get blocksRegistry(){return this.$["*blocksRegistry"]}destroyCallback(){var r;super.destroyCallback();let e=this.blocksRegistry;e==null||e.delete(this),(r=this.localeManager)==null||r.destroyL10nBindings(this),this.l10nProcessorSubs=new Map,x.deleteCtx(this),(e==null?void 0:e.size)===0&&setTimeout(()=>{this.destroyCtxCallback()},0)}destroyCtxCallback(){var e,r;x.deleteCtx(this.ctxName),(e=this.localeManager)==null||e.destroy(),this.modalManager&&((r=this.modalManager)==null||r.destroy())}async proxyUrl(e){if(this.cfg.secureDeliveryProxy&&this.cfg.secureDeliveryProxyUrlResolver&&console.warn("Both secureDeliveryProxy and secureDeliveryProxyUrlResolver are set. The secureDeliveryProxyUrlResolver will be used."),this.cfg.secureDeliveryProxyUrlResolver)try{return await this.cfg.secureDeliveryProxyUrlResolver(e,{uuid:Se(e),cdnUrlModifiers:qe(e),fileName:Ae(e)})}catch(r){return console.error("Failed to resolve secure delivery proxy URL. Falling back to the default URL.",r),e}return this.cfg.secureDeliveryProxy?Je(this.cfg.secureDeliveryProxy,{previewUrl:e},{transform:r=>window.encodeURIComponent(r)}):e}get cfg(){if(!this.__cfgProxy){let e=Object.create(null);this.__cfgProxy=new Proxy(e,{set:(r,s,o)=>{if(typeof s!="string")return!1;let n=T(s);return this.has(n)||this.add(n,M[s]),this.$[n]=o,!0},get:(r,s)=>{let o=T(s);return this.has(o)||this.add(o,M[s]),this.$[T(s)]}})}return this.__cfgProxy}subConfigValue(e,r){let s=T(e);this.has(s)||this.add(s,M[e]),this.sub(s,r)}debugPrint(...e){if(!this.cfg.debug)return;let r=e;if(typeof(e==null?void 0:e[0])=="function"){let s=e[0];r=s()}console.log(`[${this.ctxName}]`,...r)}static reg(e){if(!e){super.reg();return}e.startsWith(gr)&&super.reg(e)}};f(b,"StateConsumerScope",null),f(b,"styleAttrs",[]);var N="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=";function qt(...i){return i.reduce((t,e)=>{if(typeof e=="string")return t[e]=!0,t;for(let r of Object.keys(e))t[r]=e[r];return t},{})}function E(...i){let t=qt(...i);return Object.keys(t).reduce((e,r)=>(t[r]&&e.push(r),e),[]).join(" ")}function Yt(i,...t){let e=qt(...t);for(let r of Object.keys(e))i.classList.toggle(r,e[r])}var Zt=i=>{if(!i)return[];let[t,e]=i.split(":").map(Number);if(!Number.isFinite(t)||!Number.isFinite(e)){console.error(`Invalid crop preset: ${i}`);return}return[{type:"aspect-ratio",width:t,height:e}]};var Qt=i=>{if(!i)return $;let t=Y(i).filter(e=>$.includes(e));return t.length===0?$:t};function Jt(i){return{"*originalUrl":null,"*faderEl":null,"*cropperEl":null,"*imgEl":null,"*imgContainerEl":null,"*networkProblems":!1,"*imageSize":null,"*editorTransformations":{},"*cropPresetList":[],"*tabList":$,"*tabId":y.CROP,entry:null,extension:null,editorMode:!1,modalCaption:"",isImage:!1,msg:"",src:N,fileType:"",showLoader:!1,uuid:null,cdnUrl:null,cropPreset:"",tabs:Z($),"presence.networkProblems":!1,"presence.modalCaption":!0,"presence.editorToolbar":!1,"presence.viewerToolbar":!0,"*on.retryNetwork":()=>{let t=i.querySelectorAll("img");for(let e of t){let r=e.src;e.src=N,e.src=r}i.$["*networkProblems"]=!1},"*on.apply":t=>{if(!t)return;let e=i.$["*originalUrl"],r=z(X(t),"preview"),s=V(e,r),o={originalUrl:e,cdnUrlModifiers:r,cdnUrl:s,transformations:t};i.dispatchEvent(new CustomEvent("apply",{detail:o,bubbles:!0,composed:!0})),i.remove()},"*on.cancel":()=>{i.remove(),i.dispatchEvent(new CustomEvent("cancel",{bubbles:!0,composed:!0}))}}}var ei="<svg width='0' height='0' style='position:absolute'><symbol viewBox='0 0 20 20' id='uc-icon-brightness' xmlns='http://www.w3.org/2000/svg'><path stroke-linejoin='round' fill='none' stroke='currentColor' stroke-width='1.2' d='M15 10a5 5 0 0 1-5 5m5-5a5 5 0 0 0-5-5m5 5h-5m0 5a5 5 0 0 1 0-10m0 10V5m0 15v-3M2.93 2.929 5.05 5.05M0 10h3m-.07 7.071 2.12-2.121M10 0v3m7.07 14.071-2.12-2.121M20 10h-3m.07-7.071L14.95 5.05m-.626 2.45H10m4.324 5H10'/></symbol><symbol fill='currentColor' viewBox='0 0 20 20' id='uc-icon-closeMax' xmlns='http://www.w3.org/2000/svg'><path fill-rule='evenodd' d='M8.232 10 3.585 5.353l1.768-1.768L10 8.232l4.648-4.647 1.767 1.768L11.768 10l4.647 4.648-1.767 1.767L10 11.768l-4.647 4.647-1.768-1.767L8.232 10Z' clip-rule='evenodd'/></symbol><symbol viewBox='0 0 20 20' id='uc-icon-contrast' xmlns='http://www.w3.org/2000/svg'><path stroke-linejoin='round' fill='none' stroke='currentColor' stroke-width='1.2' d='M2 10a8 8 0 1 0 16 0 8 8 0 1 0-16 0m8-8v16m8-8h-8m7.598 2.5H10m6.24 2.5H10m7.6-7.5H10M16.242 5H10'/></symbol><symbol viewBox='0 0 20 20' id='uc-icon-crop' xmlns='http://www.w3.org/2000/svg'><path stroke-linejoin='round' fill='none' stroke='currentColor' stroke-width='1.2' d='M20 14H7.005C6.45 14 6 13.55 6 12.995V0M0 6h13.067c.515 0 .933.418.933.933V20M14.5.4 13 2l1.5 1.6M13 2h2a3 3 0 0 1 3 3v2M5.5 19.6 7 18l-1.5-1.6M7 18H5a3 3 0 0 1-3-3v-2'/></symbol><symbol fill='currentColor' viewBox='0 0 20 20' id='uc-icon-done' xmlns='http://www.w3.org/2000/svg'><path fill-rule='evenodd' d='m18.057 6.333-9.365 9.125a1.25 1.25 0 0 1-1.768-.023L1.92 10.296l1.791-1.744 4.132 4.243 8.47-8.253 1.744 1.79Z' clip-rule='evenodd'/></symbol><symbol fill='currentColor' viewBox='0 0 25 24' id='uc-icon-edit-file' xmlns='http://www.w3.org/2000/svg'><path fill-rule='evenodd' d='M18.558 2.804a.78.78 0 0 0-.557.235l-.008.007-2.472 2.46 3.847 3.848 2.46-2.473.004-.003a.78.78 0 0 0 0-1.108l-.004-.003-2.712-2.728a.78.78 0 0 0-.558-.235Zm-.248 7.613-3.852-3.852-8.93 8.887-1.516 5.41 5.41-1.515 8.888-8.93Zm-.636-8.934a2.28 2.28 0 0 1 2.512.505l2.702 2.717.002.002a2.278 2.278 0 0 1 0 3.234l-.002.002-12.541 12.602a.75.75 0 0 1-.33.193l-6.884 1.928a.75.75 0 0 1-.925-.924l1.928-6.885a.75.75 0 0 1 .193-.33l12.603-12.54a2.28 2.28 0 0 1 .742-.504Z' clip-rule='evenodd'/></symbol><symbol viewBox='0 0 20 20' id='uc-icon-enhance' xmlns='http://www.w3.org/2000/svg'><path stroke-linejoin='round' fill='none' stroke='currentColor' stroke-width='1.2' d='M19 13h-2m0 0a4 4 0 0 1-4-4m4 4a4 4 0 0 0-4 4m0-8V7m0 2a4 4 0 0 1-4 4m-2 0h2m0 0a4 4 0 0 1 4 4m0 0v2M8 8.5H6.5m0 0a2 2 0 0 1-2-2m2 2a2 2 0 0 0-2 2m0-4V5m0 1.5a2 2 0 0 1-2 2M1 8.5h1.5m0 0a2 2 0 0 1 2 2m0 0V12M12 3h-1m0 0a1 1 0 0 1-1-1m1 1a1 1 0 0 0-1 1m0-2V1m0 1a1 1 0 0 1-1 1M8 3h1m0 0a1 1 0 0 1 1 1m0 0v1'/></symbol><symbol viewBox='0 0 20 20' id='uc-icon-exposure' xmlns='http://www.w3.org/2000/svg'><path stroke-linejoin='round' fill='none' stroke='currentColor' stroke-width='1.2' d='M10 20v-3M2.93 2.929 5.05 5.05M0 10h3m-.07 7.071 2.12-2.121M10 0v3m7.07 14.071-2.12-2.121M20 10h-3m.07-7.071L14.95 5.05M5 10a5 5 0 1 0 10 0 5 5 0 1 0-10 0'/></symbol><symbol viewBox='0 0 20 20' id='uc-icon-filters' xmlns='http://www.w3.org/2000/svg'><path stroke-linejoin='round' fill='none' stroke='currentColor' stroke-width='1.2' d='M4.5 6.5a5.5 5.5 0 1 0 11 0 5.5 5.5 0 1 0-11 0m-3.5 6a5.5 5.5 0 1 0 11 0 5.5 5.5 0 1 0-11 0m7 0a5.5 5.5 0 1 0 11 0 5.5 5.5 0 1 0-11 0'/></symbol><symbol viewBox='0 0 20 20' id='uc-icon-flip' xmlns='http://www.w3.org/2000/svg'><path stroke-linejoin='round' fill='none' stroke='currentColor' stroke-width='1.2' d='M19.6 5 18 3.5 16.4 5m3.2 10L18 16.5 16.4 15M18 3.523v12.954M3.3 8.5h10.654c.301 0 .415-.395.159-.554L3.459 1.286A.3.3 0 0 0 3 1.542V8.2a.3.3 0 0 0 .3.3zm0 3h10.654c.301 0 .415.395.159.554l-10.654 6.66A.3.3 0 0 1 3 18.458v-6.66a.3.3 0 0 1 .3-.3z'/></symbol><symbol viewBox='0 0 20 20' id='uc-icon-gamma' xmlns='http://www.w3.org/2000/svg'><path stroke-linejoin='round' fill='none' stroke='currentColor' stroke-width='1.2' d='M17 3C9 6 2.5 11.5 2.5 17.5m0 0h1m-1 0v-1m14 1h1m-3 0h1m-3 0h1m-3 0h1m-3 0h1m-3 0h1m-3 0h1m-3-14v-1m0 3v-1m0 3v-1m0 3v-1m0 3v-1m0 3v-1m0 3v-1'/></symbol><symbol viewBox='0 0 20 20' id='uc-icon-mirror' xmlns='http://www.w3.org/2000/svg'><path stroke-linejoin='round' fill='none' stroke='currentColor' stroke-width='1.2' d='M5 .4 3.5 2 5 3.6M15 .4 16.5 2 15 3.6M3.52 2h12.957M8.5 16.7V6.046c0-.301-.394-.415-.554-.159L1.287 16.541a.3.3 0 0 0 .255.459H8.2a.3.3 0 0 0 .3-.3zm3 0V6.046c0-.301.395-.415.555-.159l6.659 10.654a.3.3 0 0 1-.255.459H11.8a.3.3 0 0 1-.3-.3z'/></symbol><symbol viewBox='0 0 40 40' id='uc-icon-original' xmlns='http://www.w3.org/2000/svg'><path stroke-linejoin='round' fill='none' stroke='currentColor' stroke-width='1.5' d='M0 40 40 0'/></symbol><symbol viewBox='0 0 20 20' id='uc-icon-rotate' xmlns='http://www.w3.org/2000/svg'><path stroke-linejoin='round' fill='none' stroke='currentColor' stroke-width='1.2' d='M13.5.4 12 2l1.5 1.6M12.023 2H14.4A3.6 3.6 0 0 1 18 5.6V8M4 17h9a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1z'/></symbol><symbol viewBox='0 0 20 20' id='uc-icon-sad' xmlns='http://www.w3.org/2000/svg'><path stroke-linejoin='round' fill='none' stroke='currentColor' stroke-width='1.2' d='M2 17c4.418-4 11.582-4 16 0M16.5 5a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm-11 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z'/></symbol><symbol viewBox='0 0 20 20' id='uc-icon-saturation' xmlns='http://www.w3.org/2000/svg'><defs><linearGradient id='puc-icon-id__a' x1='10.001' y1='1' x2='10.001' y2='19' gradientUnits='userSpaceOnUse'><stop stop-color='#DE15FF'/><stop offset='.203' stop-color='#0029FF'/><stop offset='.479' stop-color='#2AE4F0'/><stop offset='.604' stop-color='#15EF11'/><stop offset='.75' stop-color='#FAE528'/><stop offset='1' stop-color='#EB2A2A'/></linearGradient></defs><circle cx='10.001' cy='10' r='9' transform='rotate(90 10 10)' fill='url(#puc-icon-id__a)'/></symbol><symbol viewBox='0 0 20 20' id='uc-icon-slider' xmlns='http://www.w3.org/2000/svg'><path stroke-linejoin='round' fill='none' stroke='currentColor' stroke-width='1.2' d='M0 10h11m0 0a2 2 0 1 0 4 0m-4 0a2 2 0 1 1 4 0m0 0h5'/></symbol><symbol viewBox='0 0 20 20' id='uc-icon-tuning' xmlns='http://www.w3.org/2000/svg'><path stroke-linejoin='round' fill='none' stroke='currentColor' stroke-width='1.2' d='M8 10h11M1 10h4M1 4.5h11m3 0h4m-18 11h11m3 0h4m-7-11a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0M5 10a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0m7 5.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0'/></symbol><symbol viewBox='0 0 20 20' id='uc-icon-vibrance' xmlns='http://www.w3.org/2000/svg'><path d='M2.125 5.64A8.96 8.96 0 0 0 1.001 10a8.96 8.96 0 0 0 1.124 4.36V5.64z' fill='url(#suc-icon-id__a)'/><path d='M2.875 15.499V4.502a9.053 9.053 0 0 1 1.75-1.72v14.437a9.05 9.05 0 0 1-1.75-1.72z' fill='url(#suc-icon-id__b)'/><path d='M5.375 17.722c.548.33 1.134.601 1.75.809V1.469a8.956 8.956 0 0 0-1.75.81v15.443z' fill='url(#suc-icon-id__c)'/><path d='M7.875 1.253v17.495c.564.136 1.15.22 1.75.244V1.008a9 9 0 0 0-1.75.245z' fill='url(#suc-icon-id__d)'/><path d='M10.375 1.008v17.984a9 9 0 0 0 1.75-.244V1.252a9 9 0 0 0-1.75-.244z' fill='url(#suc-icon-id__e)'/><path d='M12.875 1.469V18.53a8.957 8.957 0 0 0 1.75-.808V2.277a8.957 8.957 0 0 0-1.75-.808z' fill='url(#suc-icon-id__f)'/><path d='M15.375 2.78v14.44a9.053 9.053 0 0 0 1.75-1.72v-11a9.054 9.054 0 0 0-1.75-1.72z' fill='url(#suc-icon-id__g)'/><path d='M17.875 5.638v8.724A8.959 8.959 0 0 0 19.001 10a8.96 8.96 0 0 0-1.126-4.362z' fill='url(#suc-icon-id__h)'/><defs><linearGradient id='suc-icon-id__a' x1='19.001' y1='10' x2='1.001' y2='10' gradientUnits='userSpaceOnUse'><stop stop-color='#DE15FF'/><stop offset='.203' stop-color='#0029FF'/><stop offset='.479' stop-color='#2AE4F0'/><stop offset='.604' stop-color='#15EF11'/><stop offset='.75' stop-color='#FAE528'/><stop offset='1' stop-color='#EB2A2A'/></linearGradient><linearGradient id='suc-icon-id__b' x1='19.001' y1='10' x2='1.001' y2='10' gradientUnits='userSpaceOnUse'><stop stop-color='#DE15FF'/><stop offset='.203' stop-color='#0029FF'/><stop offset='.479' stop-color='#2AE4F0'/><stop offset='.604' stop-color='#15EF11'/><stop offset='.75' stop-color='#FAE528'/><stop offset='1' stop-color='#EB2A2A'/></linearGradient><linearGradient id='suc-icon-id__c' x1='19.001' y1='10' x2='1.001' y2='10' gradientUnits='userSpaceOnUse'><stop stop-color='#DE15FF'/><stop offset='.203' stop-color='#0029FF'/><stop offset='.479' stop-color='#2AE4F0'/><stop offset='.604' stop-color='#15EF11'/><stop offset='.75' stop-color='#FAE528'/><stop offset='1' stop-color='#EB2A2A'/></linearGradient><linearGradient id='suc-icon-id__d' x1='19.001' y1='10' x2='1.001' y2='10' gradientUnits='userSpaceOnUse'><stop stop-color='#DE15FF'/><stop offset='.203' stop-color='#0029FF'/><stop offset='.479' stop-color='#2AE4F0'/><stop offset='.604' stop-color='#15EF11'/><stop offset='.75' stop-color='#FAE528'/><stop offset='1' stop-color='#EB2A2A'/></linearGradient><linearGradient id='suc-icon-id__e' x1='19.001' y1='10' x2='1.001' y2='10' gradientUnits='userSpaceOnUse'><stop stop-color='#DE15FF'/><stop offset='.203' stop-color='#0029FF'/><stop offset='.479' stop-color='#2AE4F0'/><stop offset='.604' stop-color='#15EF11'/><stop offset='.75' stop-color='#FAE528'/><stop offset='1' stop-color='#EB2A2A'/></linearGradient><linearGradient id='suc-icon-id__f' x1='19.001' y1='10' x2='1.001' y2='10' gradientUnits='userSpaceOnUse'><stop stop-color='#DE15FF'/><stop offset='.203' stop-color='#0029FF'/><stop offset='.479' stop-color='#2AE4F0'/><stop offset='.604' stop-color='#15EF11'/><stop offset='.75' stop-color='#FAE528'/><stop offset='1' stop-color='#EB2A2A'/></linearGradient><linearGradient id='suc-icon-id__g' x1='19.001' y1='10' x2='1.001' y2='10' gradientUnits='userSpaceOnUse'><stop stop-color='#DE15FF'/><stop offset='.203' stop-color='#0029FF'/><stop offset='.479' stop-color='#2AE4F0'/><stop offset='.604' stop-color='#15EF11'/><stop offset='.75' stop-color='#FAE528'/><stop offset='1' stop-color='#EB2A2A'/></linearGradient><linearGradient id='suc-icon-id__h' x1='19.001' y1='10' x2='1.001' y2='10' gradientUnits='userSpaceOnUse'><stop stop-color='#DE15FF'/><stop offset='.203' stop-color='#0029FF'/><stop offset='.479' stop-color='#2AE4F0'/><stop offset='.604' stop-color='#15EF11'/><stop offset='.75' stop-color='#FAE528'/><stop offset='1' stop-color='#EB2A2A'/></linearGradient></defs></symbol><symbol viewBox='0 0 20 20' id='uc-icon-warmth' xmlns='http://www.w3.org/2000/svg'><path d='m7.5 13.05.429.42.171-.175v-.244h-.6zm5 0h-.6v.245l.172.175.428-.42zM8.1 3.5c0-1.05.85-1.9 1.9-1.9V.4a3.1 3.1 0 0 0-3.1 3.1h1.2zm0 9.55V3.5H6.9v9.55h1.2zm-1 2.45c0-.79.315-1.506.829-2.03l-.858-.84A4.088 4.088 0 0 0 5.9 15.5h1.2zm2.9 2.9a2.9 2.9 0 0 1-2.9-2.9H5.9a4.1 4.1 0 0 0 4.1 4.1v-1.2zm2.9-2.9a2.9 2.9 0 0 1-2.9 2.9v1.2a4.1 4.1 0 0 0 4.1-4.1h-1.2zm-.829-2.03c.514.524.829 1.24.829 2.03h1.2c0-1.117-.447-2.13-1.171-2.87l-.858.84zM11.9 3.5v9.55h1.2V3.5h-1.2zM10 1.6c1.05 0 1.9.85 1.9 1.9h1.2A3.1 3.1 0 0 0 10 .4v1.2z' fill='currentColor'/><path d='M10 14V8' stroke='currentColor' stroke-width='1.2' stroke-linecap='round'/><path d='M14 3h3m-3 3h3m-3 3h3m-8 6.5a1 1 0 1 0 2 0 1 1 0 1 0-2 0' stroke='currentColor' stroke-width='1.2'/></symbol></svg>";var ti=`${ei} <div class="uc-wrapper uc-wrapper_desktop"><uc-presence-toggle class="uc-network_problems_splash" set="visible: presence.networkProblems;"><div class="uc-network_problems_content"><div class="uc-network_problems_icon"><uc-icon name="sad"></uc-icon></div><div class="uc-network_problems_text">Network error</div></div><div class="uc-network_problems_footer"><uc-btn-ui theme="primary" text="Retry" set="onclick: *on.retryNetwork"></uc-btn-ui></div></uc-presence-toggle><div class="uc-viewport"><div class="uc-file_type_outer"><div class="uc-file_type">{{fileType}}</div></div><div class="uc-image_container" ref="img-container-el"><img src="${N}" class="uc-image uc-image_visible_from_editor" ref="img-el" /><uc-editor-image-cropper ref="cropper-el"></uc-editor-image-cropper><uc-editor-image-fader ref="fader-el"></uc-editor-image-fader></div><div class="uc-info_pan">{{msg}}</div></div><div class="uc-toolbar"><uc-line-loader-ui set="active: showLoader"></uc-line-loader-ui><div class="uc-toolbar_content uc-toolbar_content__editor"><uc-editor-toolbar></uc-editor-toolbar></div></div></div>`;var K=class extends b{constructor(){super();f(this,"ctxOwner",!0);f(this,"_debouncedShowLoader",C(this._showLoader.bind(this),300));this.init$={...this.init$,...Jt(this)}}_showLoader(e){this.$.showLoader=e}_waitForSize(){return new Promise((r,s)=>{let o=setTimeout(()=>{s(new Error("[cloud-image-editor] timeout waiting for non-zero container size"))},3e3),n=new ResizeObserver(([l])=>{l.contentRect.width>0&&l.contentRect.height>0&&(r(),clearTimeout(o),n.disconnect())});n.observe(this)})}initCallback(){super.initCallback(),this.$["*faderEl"]=this.ref["fader-el"],this.$["*cropperEl"]=this.ref["cropper-el"],this.$["*imgContainerEl"]=this.ref["img-container-el"],this.initEditor()}async updateImage(){if(this.isConnected){if(await this._waitForSize(),this.$.cdnUrl){let e=Se(this.$.cdnUrl),r=Ye(this.$.cdnUrl,e);if(r===this.$["*originalUrl"])return;this.$["*originalUrl"]=r;let s=xt(this.$.cdnUrl),o=$t(s);this.$["*editorTransformations"]=o}else if(this.$.uuid){let e=Ye(this.cfg.cdnCname,this.$.uuid);if(e===this.$["*originalUrl"])return;this.$["*originalUrl"]=e,this.$["*editorTransformations"]={}}else throw new Error("No UUID nor CDN URL provided");this.$["*tabId"]===y.CROP?this.$["*cropperEl"].deactivate({reset:!0}):this.$["*faderEl"].deactivate();try{let e=await this.proxyUrl(V(this.$["*originalUrl"],z("json"))),r=await fetch(e).then(n=>n.json()),{width:s,height:o}=r;this.$["*imageSize"]={width:s,height:o},this.$["*tabId"]===y.CROP?this.$["*cropperEl"].activate(this.$["*imageSize"]):this.$["*faderEl"].activate({url:this.$["*originalUrl"]})}catch(e){e&&console.error("Failed to load image info",e)}}}async initEditor(){try{await this._waitForSize()}catch(e){this.isConnected&&console.error(e.message);return}this.ref["img-el"].addEventListener("load",()=>{this._imgLoading=!1,this._debouncedShowLoader(!1),this.$.src!==N&&(this.$["*networkProblems"]=!1)}),this.ref["img-el"].addEventListener("error",()=>{this._imgLoading=!1,this._debouncedShowLoader(!1),this.$["*networkProblems"]=!0}),this.sub("src",e=>{let r=this.ref["img-el"];r.src!==e&&(this._imgLoading=!0,r.src=e||N)}),this.sub("cropPreset",e=>{this.$["*cropPresetList"]=Zt(e)}),this.sub("tabs",e=>{this.$["*tabList"]=Qt(e)}),this.sub("*tabId",e=>{this.ref["img-el"].className=E("uc-image",{"uc-image_hidden_to_cropper":e===y.CROP,"uc-image_hidden_effects":e!==y.CROP})}),this.classList.add("uc-editor_ON"),this.sub("*networkProblems",e=>{this.$["presence.networkProblems"]=e,this.$["presence.modalCaption"]=!e}),this.sub("*editorTransformations",e=>{if(Object.keys(e).length===0)return;let r=this.$["*originalUrl"],s=z(X(e),"preview"),o=V(r,s),n={originalUrl:r,cdnUrlModifiers:s,cdnUrl:o,transformations:e};this.dispatchEvent(new CustomEvent("change",{detail:n,bubbles:!0,composed:!0}))},!1),this.sub("uuid",e=>e&&this.updateImage()),this.sub("cdnUrl",e=>e&&this.updateImage())}};f(K,"styleAttrs",["uc-cloud-image-editor"]);K.template=ti;K.bindAttributes({uuid:"uuid","cdn-url":"cdnUrl","crop-preset":"cropPreset",tabs:"tabs"});var fe=33.333333333333336,p=1,st=24,ii=6;function G(i,t){for(let e in t)i.setAttributeNS(null,e,t[e].toString())}function I(i,t={}){let e=document.createElementNS("http://www.w3.org/2000/svg",i);return G(e,t),e}function ri(i,t,e){let{x:r,y:s,width:o,height:n}=i,l=t.includes("w")?0:1,a=t.includes("n")?0:1,c=[-1,1][l],u=[-1,1][a],h=[r+l*o+1.5*c,s+a*n+1.5*u-24*e*u],d=[r+l*o+1.5*c,s+a*n+1.5*u],m=[r+l*o-24*e*c+1.5*c,s+a*n+1.5*u];return{d:`M ${h[0]} ${h[1]} L ${d[0]} ${d[1]} L ${m[0]} ${m[1]}`,center:d}}function si(i,t,e){let{x:r,y:s,width:o,height:n}=i,l=["n","s"].includes(t)?.5:{w:0,e:1}[t],a=["w","e"].includes(t)?.5:{n:0,s:1}[t],c=[-1,1][l],u=[-1,1][a],h,d;["n","s"].includes(t)?(h=[r+l*o-34*e/2,s+a*n+1.5*u],d=[r+l*o+34*e/2,s+a*n+1.5*u]):(h=[r+l*o+1.5*c,s+a*n-34*e/2],d=[r+l*o+1.5*c,s+a*n+34*e/2]);let m=`M ${h[0]} ${h[1]} L ${d[0]} ${d[1]}`,g=[d[0]-(d[0]-h[0])/2,d[1]-(d[1]-h[1])/2];return{d:m,center:g}}function oi(i){return i===""?"move":["e","w"].includes(i)?"ew-resize":["n","s"].includes(i)?"ns-resize":["nw","se"].includes(i)?"nwse-resize":"nesw-resize"}function ni({rect:i,delta:[t,e],imageBox:r}){return se({...i,x:i.x+t,y:i.y+e},r)}function se(i,t){let{x:e}=i,{y:r}=i;return i.x<t.x?e=t.x:i.x+i.width>t.x+t.width&&(e=t.x+t.width-i.width),i.y<t.y?r=t.y:i.y+i.height>t.y+t.height&&(r=t.y+t.height-i.height),{...i,x:e,y:r}}function br({rect:i,delta:t,aspectRatio:e,imageBox:r}){let[,s]=t,{y:o,width:n,height:l}=i;o+=s,l-=s,e&&(n=l*e);let a=i.x+i.width/2-n/2;return o<=r.y&&(o=r.y,l=i.y+i.height-o,e&&(n=l*e,a=i.x+i.width/2-n/2)),a<=r.x&&(a=r.x,o=i.y+i.height-l),a+n>=r.x+r.width&&(a=Math.max(r.x,r.x+r.width-n),n=r.x+r.width-a,e&&(l=n/e),o=i.y+i.height-l),l<p&&(l=p,e&&(n=l*e,a=i.x+i.width/2-n/2),o=i.y+i.height-l),n<p&&(n=p,e&&(l=n/e,a=i.x+i.width/2-n/2),o=i.y+i.height-l),{x:a,y:o,width:n,height:l}}function yr({rect:i,delta:t,aspectRatio:e,imageBox:r}){let[s]=t,{x:o,width:n,height:l}=i;o+=s,n-=s,e&&(l=n/e);let a=i.y+i.height/2-l/2;return o<=r.x&&(o=r.x,n=i.x+i.width-o,e&&(l=n/e,a=i.y+i.height/2-l/2)),a<=r.y&&(a=r.y,o=i.x+i.width-n),a+l>=r.y+r.height&&(a=Math.max(r.y,r.y+r.height-l),l=r.y+r.height-a,e&&(n=l*e),o=i.x+i.width-n),l<p&&(l=p,e&&(n=l*e),a=i.y+i.height/2-l/2,o=i.x+i.width-n),n<p&&(n=p,e&&(l=n/e),a=i.y+i.height/2-l/2,o=i.x+i.width-n),{x:o,y:a,width:n,height:l}}function vr({rect:i,delta:t,aspectRatio:e,imageBox:r}){let[,s]=t,{y:o,width:n,height:l}=i;l+=s,e&&(n=l*e);let a=i.x+i.width/2-n/2;return o+l>=r.y+r.height&&(l=r.y+r.height-o,e&&(n=l*e),a=i.x+i.width/2-n/2),a<=r.x&&(a=r.x,o=i.y),a+n>=r.x+r.width&&(a=Math.max(r.x,r.x+r.width-n),n=r.x+r.width-a,e&&(l=n/e),o=i.y),l<p&&(l=p,e&&(n=l*e),a=i.x+i.width/2-n/2),n<p&&(n=p,e&&(l=n/e),a=i.x+i.width/2-n/2),{x:a,y:o,width:n,height:l}}function wr({rect:i,delta:t,aspectRatio:e,imageBox:r}){let[s]=t,{x:o,width:n,height:l}=i;n+=s,e&&(l=n/e);let a=i.y+i.height/2-l/2;return o+n>=r.x+r.width&&(n=r.x+r.width-o,e&&(l=n/e),a=i.y+i.height/2-l/2),a<=r.y&&(a=r.y,o=i.x),a+l>=r.y+r.height&&(a=Math.max(r.y,r.y+r.height-l),l=r.y+r.height-a,e&&(n=l*e),o=i.x),l<p&&(l=p,e&&(n=l*e),a=i.y+i.height/2-l/2),n<p&&(n=p,e&&(l=n/e),a=i.y+i.height/2-l/2),{x:o,y:a,width:n,height:l}}function xr({rect:i,delta:t,aspectRatio:e,imageBox:r}){let[s,o]=t,{x:n,y:l,width:a,height:c}=i;return n+s<r.x&&(s=r.x-n),l+o<r.y&&(o=r.y-l),n+=s,a-=s,l+=o,c-=o,e&&Math.abs(a/c)>e?(o=a/e-c,c+=o,l-=o,l<=r.y&&(c=c-(r.y-l),a=c*e,n=i.x+i.width-a,l=r.y)):e&&(s=c*e-a,a=a+s,n-=s,n<=r.x&&(a=a-(r.x-n),c=a/e,n=r.x,l=i.y+i.height-c)),c<p&&(c=p,e&&(a=c*e),n=i.x+i.width-a,l=i.y+i.height-c),a<p&&(a=p,e&&(c=a/e),n=i.x+i.width-a,l=i.y+i.height-c),{x:n,y:l,width:a,height:c}}function Er({rect:i,delta:t,aspectRatio:e,imageBox:r}){let[s,o]=t,{x:n,y:l,width:a,height:c}=i;return n+a+s>r.x+r.width&&(s=r.x+r.width-n-a),l+o<r.y&&(o=r.y-l),a+=s,l+=o,c-=o,e&&Math.abs(a/c)>e?(o=a/e-c,c+=o,l-=o,l<=r.y&&(c=c-(r.y-l),a=c*e,n=i.x,l=r.y)):e&&(s=c*e-a,a+=s,n+a>=r.x+r.width&&(a=r.x+r.width-n,c=a/e,n=r.x+r.width-a,l=i.y+i.height-c)),c<p&&(c=p,e&&(a=c*e),l=i.y+i.height-c),a<p&&(a=p,e&&(c=a/e),l=i.y+i.height-c),{x:n,y:l,width:a,height:c}}function Cr({rect:i,delta:t,aspectRatio:e,imageBox:r}){let[s,o]=t,{x:n,y:l,width:a,height:c}=i;return n+s<r.x&&(s=r.x-n),l+c+o>r.y+r.height&&(o=r.y+r.height-l-c),n+=s,a-=s,c+=o,e&&Math.abs(a/c)>e?(o=a/e-c,c+=o,l+c>=r.y+r.height&&(c=r.y+r.height-l,a=c*e,n=i.x+i.width-a,l=r.y+r.height-c)):e&&(s=c*e-a,a+=s,n-=s,n<=r.x&&(a=a-(r.x-n),c=a/e,n=r.x,l=i.y)),c<p&&(c=p,e&&(a=c*e),n=i.x+i.width-a),a<p&&(a=p,e&&(c=a/e),n=i.x+i.width-a),{x:n,y:l,width:a,height:c}}function Tr({rect:i,delta:t,aspectRatio:e,imageBox:r}){let[s,o]=t,{x:n,y:l,width:a,height:c}=i;return n+a+s>r.x+r.width&&(s=r.x+r.width-n-a),l+c+o>r.y+r.height&&(o=r.y+r.height-l-c),a+=s,c+=o,e&&Math.abs(a/c)>e?(o=a/e-c,c+=o,l+c>=r.y+r.height&&(c=r.y+r.height-l,a=c*e,n=i.x,l=r.y+r.height-c)):e&&(s=c*e-a,a+=s,n+a>=r.x+r.width&&(a=r.x+r.width-n,c=a/e,n=r.x+r.width-a,l=i.y)),c<p&&(c=p,e&&(a=c*e)),a<p&&(a=p,e&&(c=a/e)),{x:n,y:l,width:a,height:c}}function li({direction:i,...t}){switch(i){case"n":return br(t);case"w":return yr(t);case"s":return vr(t);case"e":return wr(t);case"nw":return xr(t);case"ne":return Er(t);case"sw":return Cr(t);case"se":return Tr(t);default:return t.rect}}function ai(i,[t,e]){return i.x<=t&&t<=i.x+i.width&&i.y<=e&&e<=i.y+i.height}function ci(i,t){return i.x>=t.x&&i.y>=t.y&&i.x+i.width<=t.x+t.width&&i.y+i.height<=t.y+t.height}function hi(i,t){return Math.abs(i.width/i.height-t)<.1}function oe({width:i,height:t},e){let r=e/90%2!==0;return{width:r?t:i,height:r?i:t}}function ne(i){return{x:Math.round(i.x),y:Math.round(i.y),width:Math.round(i.width),height:Math.round(i.height)}}function W(i,t,e){return Math.min(Math.max(i,t),e)}var Re=class extends b{constructor(){super(),this.init$={...this.init$,dragging:!1},this._handlePointerUp=this._handlePointerUp_.bind(this),this._handlePointerMove=this._handlePointerMove_.bind(this),this._handleSvgPointerMove=this._handleSvgPointerMove_.bind(this)}_shouldThumbBeDisabled(t){let e=this.$["*imageBox"];if(!e)return;if(t===""&&e.height<=p&&e.width<=p)return!0;let r=e.height<=p&&(t.includes("n")||t.includes("s")),s=e.width<=p&&(t.includes("e")||t.includes("w"));return r||s}_createBackdrop(){let t=this.$["*cropBox"];if(!t)return;let{x:e,y:r,width:s,height:o}=t,n=this.ref["svg-el"],l=I("mask",{id:"backdrop-mask"}),a=I("rect",{x:0,y:0,width:"100%",height:"100%",fill:"white"}),c=I("rect",{x:e,y:r,width:s,height:o,fill:"black"});l.appendChild(a),l.appendChild(c);let u=I("rect",{x:0,y:0,width:"100%",height:"100%",fill:"var(--color-image-background)","fill-opacity":.85,mask:"url(#backdrop-mask)"});n.appendChild(u),n.appendChild(l),this._backdropMask=l,this._backdropMaskInner=c}_resizeBackdrop(){this._backdropMask&&(this._backdropMask.style.display="none",window.requestAnimationFrame(()=>{this._backdropMask&&(this._backdropMask.style.display="block")}))}_updateBackdrop(){let t=this.$["*cropBox"];if(!t)return;let{x:e,y:r,width:s,height:o}=t;this._backdropMaskInner&&G(this._backdropMaskInner,{x:e,y:r,width:s,height:o})}_updateFrame(){let t=this.$["*cropBox"];if(!(!t||!this._frameGuides||!this._frameThumbs)){for(let e of Object.values(this._frameThumbs)){let{direction:r,pathNode:s,interactionNode:o,groupNode:n}=e,l=r==="",a=r.length===2,{x:c,y:u,width:h,height:d}=t;if(l)G(o,{x:c,y:u,width:h,height:d});else{let g=W(Math.min(h,d)/(24*2+34)/2,0,1),{d:A,center:S}=a?ri(t,r,g):si(t,r,g),k=Math.max(st*W(Math.min(h,d)/st/3,0,1),ii);G(o,{x:S[0]-k,y:S[1]-k,width:k*2,height:k*2}),G(s,{d:A})}let m=this._shouldThumbBeDisabled(r);n.setAttribute("class",E("uc-thumb",{"uc-thumb--hidden":m,"uc-thumb--visible":!m}))}G(this._frameGuides,{x:t.x-1*.5,y:t.y-1*.5,width:t.width+1,height:t.height+1})}}_createThumb(t,e){let r=I("g");r.classList.add("uc-thumb"),r.setAttribute("with-effects","");let s=I("rect",{fill:"transparent"}),o=I("path",{stroke:"currentColor",fill:"none","stroke-width":3});r.appendChild(o),r.appendChild(s),t[e]={direction:e,pathNode:o,interactionNode:s,groupNode:r},e===""&&(r.style.cursor="move"),s.addEventListener("pointerdown",this._handlePointerDown.bind(this,e))}_createThumbs(){let t={};for(let e=0;e<3;e++)for(let r=0;r<3;r++){let s=`${["n","","s"][e]}${["w","","e"][r]}`;s!==""&&this._createThumb(t,s)}return this._createThumb(t,""),t}_createGuides(){let t=I("svg"),e=I("rect",{x:0,y:0,width:"100%",height:"100%",fill:"none",stroke:"currentColor","stroke-width":1,"stroke-opacity":.5});t.appendChild(e);for(let r=1;r<=2;r++){let s=I("line",{x1:`${fe*r}%`,y1:"0%",x2:`${fe*r}%`,y2:"100%",stroke:"currentColor","stroke-width":1,"stroke-opacity":.3});t.appendChild(s)}for(let r=1;r<=2;r++){let s=I("line",{x1:"0%",y1:`${fe*r}%`,x2:"100%",y2:`${fe*r}%`,stroke:"currentColor","stroke-width":1,"stroke-opacity":.3});t.appendChild(s)}return t.classList.add("uc-guides","uc-guides--semi-hidden"),t}_createFrame(){let t=this.ref["svg-el"],e=document.createDocumentFragment(),r=this._createGuides();e.appendChild(r);let s=this._createThumbs();for(let{groupNode:o}of Object.values(s))e.appendChild(o);t.appendChild(e),this._frameThumbs=s,this._frameGuides=r}_handlePointerDown(t,e){if(!this._frameThumbs)return;let r=this._frameThumbs[t];if(this._shouldThumbBeDisabled(t))return;let s=this.$["*cropBox"],{x:o,y:n}=this.ref["svg-el"].getBoundingClientRect(),l=e.x-o,a=e.y-n;this.$.dragging=!0,this._draggingThumb=r,this._dragStartPoint=[l,a],this._dragStartCrop={...s}}_handlePointerUp_(t){this._updateCursor(),this.$.dragging&&(t.stopPropagation(),t.preventDefault(),this.$.dragging=!1)}_handlePointerMove_(t){if(!this.$.dragging||!this._dragStartPoint||!this._draggingThumb)return;t.stopPropagation(),t.preventDefault();let e=this.ref["svg-el"],{x:r,y:s}=e.getBoundingClientRect(),o=t.x-r,n=t.y-s,l=o-this._dragStartPoint[0],a=n-this._dragStartPoint[1],{direction:c}=this._draggingThumb,u=this._calcCropBox(c,[l,a]);u&&(this.$["*cropBox"]=u)}_calcCropBox(t,e){var c,u;let[r,s]=e,o=this.$["*imageBox"],n=(c=this._dragStartCrop)!=null?c:this.$["*cropBox"],l=(u=this.$["*cropPresetList"])==null?void 0:u[0],a=l?l.width/l.height:void 0;if(t===""?n=ni({rect:n,delta:[r,s],imageBox:o}):n=li({rect:n,delta:[r,s],direction:t,aspectRatio:a,imageBox:o}),!Object.values(n).every(h=>Number.isFinite(h)&&h>=0)){console.error("CropFrame is trying to create invalid rectangle",{payload:n});return}return se(ne(n),this.$["*imageBox"])}_handleSvgPointerMove_(t){if(!this._frameThumbs)return;let e=Object.values(this._frameThumbs).find(r=>{if(this._shouldThumbBeDisabled(r.direction))return!1;let o=r.interactionNode.getBoundingClientRect(),n={x:o.x,y:o.y,width:o.width,height:o.height};return ai(n,[t.x,t.y])});this._hoverThumb=e,this._updateCursor()}_updateCursor(){let t=this._hoverThumb;this.ref["svg-el"].style.cursor=t?oi(t.direction):"initial"}_createMask(t){if(this._frameImage){this._frameImage.setAttribute("href",t);return}let e=this.ref["svg-el"],r=document.createDocumentFragment(),s=I("image",{href:t});s.setAttribute("class","uc-cloud-mask"),r.appendChild(s),e.appendChild(r),this._frameImage=s}_updateMask(){let t=this.$["*cropBox"];if(!t||!this._frameImage)return;let{x:e,y:r,width:s,height:o}=t;G(this._frameImage,{x:e,y:r,height:o,width:s})}_render(){this._updateBackdrop(),this._updateFrame(),this._updateMask()}toggleThumbs(t){this._frameThumbs&&Object.values(this._frameThumbs).map(({groupNode:e})=>e).forEach(e=>{e.setAttribute("class",E("uc-thumb",{"uc-thumb--hidden":!t,"uc-thumb--visible":t}))})}initCallback(){super.initCallback(),this._createBackdrop(),this._createFrame(),this.sub("*imageBox",()=>{this._resizeBackdrop(),window.requestAnimationFrame(()=>{this._render()})}),this.sub("*cropBox",t=>{t&&(this._guidesHidden=t.height<=p||t.width<=p,window.requestAnimationFrame(()=>{this._render()}))}),this.subConfigValue("cloudImageEditorMaskHref",t=>{t&&this._createMask(t)}),this.sub("dragging",t=>{this._frameGuides&&this._frameGuides.setAttribute("class",E({"uc-guides--hidden":this._guidesHidden,"uc-guides--visible":!this._guidesHidden&&t,"uc-guides--semi-hidden":!this._guidesHidden&&!t}))}),this.ref["svg-el"].addEventListener("pointermove",this._handleSvgPointerMove,!0),document.addEventListener("pointermove",this._handlePointerMove,!0),document.addEventListener("pointerup",this._handlePointerUp,!0)}destroyCallback(){super.destroyCallback(),document.removeEventListener("pointermove",this._handlePointerMove),document.removeEventListener("pointerup",this._handlePointerUp)}};Re.template='<svg class="uc-svg" ref="svg-el" xmlns="http://www.w3.org/2000/svg"></svg>';var B=class extends b{constructor(){super(...arguments);f(this,"init$",{...this.init$,active:!1,title:"",icon:"","on.click":null,"title-prop":""})}initCallback(){super.initCallback(),this._titleEl=this.ref["title-el"],this._iconEl=this.ref["icon-el"],this.sub("title",e=>{this._titleEl&&(this._titleEl.style.display=e?"block":"none")}),this.sub("active",e=>{this.className=E({"uc-active":e,"uc-not_active":!e})}),this.sub("on.click",e=>{this.onclick=e})}};B.template=`<button role="option" type="button" set="@aria-label:title-prop;" l10n="@title:title-prop;"><uc-icon set="@name: icon;"></uc-icon><div class="uc-title" ref="title-el">{{title}}</div></button>`;function Sr(i){let t=i+90;return t=t>=360?0:t,t}function $r(i,t){return i==="rotate"?Sr(t):["mirror","flip"].includes(i)?!t:null}var pe=class extends B{initCallback(){super.initCallback(),this.defineAccessor("operation",t=>{t&&(this._operation=t,this.$.icon=t,this.bindL10n("title-prop",()=>this.l10n("a11y-cloud-editor-apply-crop",{name:this.l10n(t).toLowerCase()})))}),this.$["on.click"]=()=>{let t=this.$["*cropperEl"].getValue(this._operation),e=$r(this._operation,t);this.$["*cropperEl"].setValue(this._operation,e)}}};var me={FILTER:"filter",COLOR_OPERATION:"color_operation"},U="original",Ne=class extends b{constructor(){super(...arguments);f(this,"init$",{...this.init$,disabled:!1,min:0,max:100,value:0,defaultValue:0,zero:0,"on.input":e=>{this.$["*faderEl"].set(e),this.$.value=e}})}setOperation(e,r){this._controlType=e==="filter"?me.FILTER:me.COLOR_OPERATION,this._operation=e,this._iconName=e,this._title=e.toUpperCase(),this._filter=r,this._initializeValues(),this.$["*faderEl"].activate({url:this.$["*originalUrl"],operation:this._operation,value:this._filter===U?void 0:this.$.value,filter:this._filter===U?void 0:this._filter,fromViewer:!1})}_initializeValues(){let{range:e,zero:r}=R[this._operation],[s,o]=e;this.$.min=s,this.$.max=o,this.$.zero=r;let n=this.$["*editorTransformations"][this._operation];if(this._controlType===me.FILTER){let l=o;if(n){let{name:a,amount:c}=n;l=a===this._filter?c:o}this.$.value=l,this.$.defaultValue=l}if(this._controlType===me.COLOR_OPERATION){let l=typeof n!="undefined"?n:r;this.$.value=l,this.$.defaultValue=l}}apply(){let e;this._controlType===me.FILTER?this._filter===U?e=null:e={name:this._filter,amount:this.$.value}:e=this.$.value;let r={...this.$["*editorTransformations"],[this._operation]:e};this.$["*editorTransformations"]=r}cancel(){this.$["*faderEl"].deactivate({hide:!1})}initCallback(){super.initCallback(),this.sub("*originalUrl",e=>{this._originalUrl=e}),this.sub("value",e=>{let r=`${this._filter||this._operation} ${e}`;this.$["*operationTooltip"]=r})}};Ne.template=`<uc-slider-ui ref="slider-el" set="disabled: disabled; min: min; max: max; defaultValue: defaultValue; zero: zero; onInput: on.input;" ></uc-slider-ui>`;function _e(i){let t=new Image;return{promise:new Promise((s,o)=>{t.src=i,t.onload=s,t.onerror=o}),image:t,cancel:()=>{t.naturalWidth===0&&(t.src=N)}}}function ge(i){let t=[];for(let o of i){let n=_e(o);t.push(n)}let e=t.map(o=>o.image);return{promise:Promise.allSettled(t.map(o=>o.promise)),images:e,cancel:()=>{t.forEach(o=>{o.cancel()})}}}var le=class extends B{constructor(){super(),this.init$={...this.init$,active:!1,title:"",icon:"",isOriginal:!1,iconSize:"20","on.click":null}}_previewSrc(){let t=parseInt(window.getComputedStyle(this).getPropertyValue("--l-base-min-width"),10),e=window.devicePixelRatio,r=Math.ceil(e*t),s=e>=2?"lightest":"normal",o=100,n={...this.$["*editorTransformations"]};return n[this._operation]=this._filter!==U?{name:this._filter,amount:o}:void 0,V(this._originalUrl,z($e,X(n),`quality/${s}`,`scale_crop/${r}x${r}/center`))}async _observerCallback(t,e){var s;if(t[0].isIntersecting){let o=await this.proxyUrl(this._previewSrc()),n=this.ref["preview-el"],{promise:l,cancel:a}=_e(o);this._cancelPreload=a,l.catch(c=>{this.$["*networkProblems"]=!0,console.error("Failed to load image",{error:c})}).finally(()=>{n.style.backgroundImage=`url(${o})`,n.setAttribute("loaded",""),e.unobserve(this)})}else(s=this._cancelPreload)==null||s.call(this)}initCallback(){super.initCallback(),this.$["on.click"]=()=>{this.$.active?this.$.isOriginal||(this.$["*sliderEl"].setOperation(this._operation,this._filter),this.$["*showSlider"]=!0):(this.$["*sliderEl"].setOperation(this._operation,this._filter),this.$["*sliderEl"].apply()),this.$["*currentFilter"]=this._filter},this.defineAccessor("filter",e=>{this._operation="filter",this._filter=e,this.$.isOriginal=e===U,this.$.icon=this.$.isOriginal?"original":"slider",this.bindL10n("title-prop",()=>this.l10n("a11y-cloud-editor-apply-filter",{name:e.toLowerCase()}))}),this._observer=new window.IntersectionObserver(this._observerCallback.bind(this),{threshold:[0,1]});let t=this.$["*originalUrl"];this._originalUrl=t,this.$.isOriginal?this.ref["icon-el"].classList.add("uc-original-icon"):this._observer.observe(this),this.sub("*currentFilter",e=>{this.$.active=e&&e===this._filter}),this.sub("isOriginal",e=>{this.$.iconSize=e?40:20}),this.sub("active",e=>{if(this.$.isOriginal)return;let r=this.ref["icon-el"];r.style.opacity=e?"1":"0";let s=this.ref["preview-el"];e?s.style.opacity="0":s.style.backgroundImage&&(s.style.opacity="1")}),this.sub("*networkProblems",async e=>{if(!e){let r=await this.proxyUrl(this._previewSrc()),s=this.ref["preview-el"];s.style.backgroundImage&&(s.style.backgroundImage="none",s.style.backgroundImage=`url(${r})`)}})}destroyCallback(){var t,e;super.destroyCallback(),(t=this._observer)==null||t.disconnect(),(e=this._cancelPreload)==null||e.call(this)}};le.template=`<button type="button" role="option" l10n="@title:title-prop;@aria-label:title-prop"><div class="uc-preview" ref="preview-el"></div><uc-icon ref="icon-el" set="@name: icon; @size: iconSize;"></uc-icon></button>`;var be=class extends B{constructor(){super(...arguments);f(this,"_operation","")}initCallback(){super.initCallback(),this.$["on.click"]=e=>{this.$["*sliderEl"].setOperation(this._operation),this.$["*showSlider"]=!0,this.$["*currentOperation"]=this._operation},this.defineAccessor("operation",e=>{e&&(this._operation=e,this.$.icon=e,this.bindL10n("title-prop",()=>this.l10n("a11y-cloud-editor-apply-tuning",{name:this.l10n(e).toLowerCase()})),this.bindL10n("title",()=>this.l10n(e)))}),this.sub("*editorTransformations",e=>{if(!this._operation)return;let{zero:r}=R[this._operation],s=e[this._operation],o=typeof s!="undefined"?s!==r:!1;this.$.active=o})}};var ui=(i,t)=>{let e,r,s,o=(...n)=>{e?(clearTimeout(r),r=setTimeout(()=>{Date.now()-s>=t&&(i(...n),s=Date.now())},Math.max(t-(Date.now()-s),0))):(i(...n),s=Date.now(),e=!0)};return Object.defineProperty(o,"cancel",{configurable:!1,writable:!1,enumerable:!1,value:()=>{clearTimeout(r)}}),o};function di(i,t){let e={};for(let r of t){let s=i[r];(i.hasOwnProperty(r)||s!==void 0)&&(e[r]=s)}return e}var fi="blocks",pi="1.18.0";function ae(i,t,e){let s=window.devicePixelRatio,o=Math.min(Math.ceil(t*s),3e3),n=s>=2?"lightest":"normal";return V(i,z($e,X(e),`quality/${n}`,`stretch/off/-/resize/${o}x`,`@clib/${fi}/${pi}/uc-cloud-image-editor/`))}function Or(i){return i?[({dimensions:e,coords:r})=>[...e,...r].every(s=>Number.isInteger(s)&&Number.isFinite(s)),({dimensions:e,coords:r})=>e.every(s=>s>0)&&r.every(s=>s>=0)].every(e=>e(i)):!0}var De=class extends b{constructor(){super();f(this,"ctxOwner",!0);this.init$={...this.init$,image:null,"*padding":20,"*operations":{rotate:0,mirror:!1,flip:!1},"*imageBox":{x:0,y:0,width:0,height:0},"*cropBox":{x:0,y:0,width:0,height:0}},this._commitDebounced=C(this._commit.bind(this),300),this._handleResizeThrottled=ui(this._handleResize.bind(this),100),this._imageSize={width:0,height:0}}_handleResize(){!this.isConnected||!this._isActive||(this._initCanvas(),this._syncTransformations(),this._alignImage(),this._alignCrop(),this._draw())}_syncTransformations(){let e=this.$["*editorTransformations"],r=di(e,Object.keys(this.$["*operations"])),s={...this.$["*operations"],...r};this.$["*operations"]=s}_initCanvas(){let e=this.ref["canvas-el"],r=e.getContext("2d"),s=this.offsetWidth,o=this.offsetHeight,n=window.devicePixelRatio;e.style.width=`${s}px`,e.style.height=`${o}px`,e.width=s*n,e.height=o*n,r==null||r.scale(n,n),this._canvas=e,this._ctx=r}_alignImage(){if(!this._isActive||!this.$.image)return;let e=this.$.image,r=this.$["*padding"],s=this.$["*operations"],{rotate:o}=s,n={width:this.offsetWidth,height:this.offsetHeight},l=oe({width:e.naturalWidth,height:e.naturalHeight},o),a;if(l.width>n.width-r*2||l.height>n.height-r*2){let c=l.width/l.height,u=n.width/n.height;if(c>u){let h=n.width-r*2,d=h/c,m=0+r,g=r+(n.height-r*2)/2-d/2;a={x:m,y:g,width:h,height:d}}else{let h=n.height-r*2,d=h*c,m=r+(n.width-r*2)/2-d/2,g=0+r;a={x:m,y:g,width:d,height:h}}}else{let{width:c,height:u}=l,h=r+(n.width-r*2)/2-c/2,d=r+(n.height-r*2)/2-u/2;a={x:h,y:d,width:c,height:u}}this.$["*imageBox"]=ne(a)}_alignCrop(){var d;let e=this.$["*cropBox"],r=this.$["*imageBox"],s=this.$["*operations"],{rotate:o}=s,n=this.$["*editorTransformations"].crop,{width:l,x:a,y:c}=this.$["*imageBox"];if(n){let{dimensions:[m,g],coords:[A,S]}=n,{width:k}=oe(this._imageSize,o),q=l/k;e=se(ne({x:a+A*q,y:c+S*q,width:m*q,height:g*q}),this.$["*imageBox"])}let u=(d=this.$["*cropPresetList"])==null?void 0:d[0],h=u?u.width/u.height:void 0;if(!ci(e,r)||h&&!hi(e,h)){let m=r.width/r.height,g=r.width,A=r.height;h&&(m>h?g=Math.min(r.height*h,r.width):A=Math.min(r.width/h,r.height)),e={x:r.x+r.width/2-g/2,y:r.y+r.height/2-A/2,width:g,height:A}}this.$["*cropBox"]=se(ne(e),this.$["*imageBox"])}_drawImage(){let e=this._ctx;if(!e)return;let r=this.$.image,s=this.$["*imageBox"],o=this.$["*operations"],{mirror:n,flip:l,rotate:a}=o,c=oe({width:s.width,height:s.height},a);e.save(),e.translate(s.x+s.width/2,s.y+s.height/2),e.rotate(a*Math.PI*-1/180),e.scale(n?-1:1,l?-1:1),e.drawImage(r,-c.width/2,-c.height/2,c.width,c.height),e.restore()}_draw(){if(!this._isActive||!this.$.image||!this._canvas||!this._ctx)return;let e=this._canvas;this._ctx.clearRect(0,0,e.width,e.height),this._drawImage()}_animateIn({fromViewer:e}){this.$.image&&(this.ref["frame-el"].toggleThumbs(!0),this._transitionToImage(),setTimeout(()=>{this.className=E({"uc-active_from_viewer":e,"uc-active_from_editor":!e,"uc-inactive_to_editor":!1})}))}_getCropDimensions(){let e=this.$["*cropBox"],r=this.$["*imageBox"],s=this.$["*operations"],{rotate:o}=s,{width:n,height:l}=r,{width:a,height:c}=oe(this._imageSize,o),{width:u,height:h}=e,d=n/a,m=l/c;return[W(Math.round(u/d),1,a),W(Math.round(h/m),1,c)]}_getCropTransformation(){let e=this.$["*cropBox"],r=this.$["*imageBox"],s=this.$["*operations"],{rotate:o}=s,{width:n,height:l,x:a,y:c}=r,{width:u,height:h}=oe(this._imageSize,o),{x:d,y:m}=e,g=n/u,A=l/h,S=this._getCropDimensions(),k={dimensions:S,coords:[W(Math.round((d-a)/g),0,u-S[0]),W(Math.round((m-c)/A),0,h-S[1])]};if(!Or(k)){console.error("Cropper is trying to create invalid crop object",{payload:k});return}if(!(S[0]===u&&S[1]===h))return k}_commit(){if(!this.isConnected||!this._imageSize)return;let e=this.$["*operations"],{rotate:r,mirror:s,flip:o}=e,n=this._getCropTransformation(),a={...this.$["*editorTransformations"],crop:n,rotate:r,mirror:s,flip:o};this.$["*editorTransformations"]=a}setValue(e,r){this.$["*operations"]={...this.$["*operations"],[e]:r},this._isActive&&(this._alignImage(),this._alignCrop(),this._draw())}getValue(e){return this.$["*operations"][e]}async activate(e,{fromViewer:r}={}){if(!this._isActive){this._isActive=!0,this._imageSize=e,this.removeEventListener("transitionend",this._reset);try{this.$.image=await this._waitForImage(this.$["*originalUrl"],this.$["*editorTransformations"]),this._syncTransformations(),this._animateIn({fromViewer:r})}catch(s){console.error("Failed to activate cropper",{error:s})}this._observer=new ResizeObserver(([s])=>{s.contentRect.width>0&&s.contentRect.height>0&&this._isActive&&this.$.image&&this._handleResizeThrottled()}),this._observer.observe(this)}}deactivate({reset:e=!1}={}){var r;this._isActive&&(!e&&this._commit(),this._isActive=!1,this._transitionToCrop(),this.className=E({"uc-active_from_viewer":!1,"uc-active_from_editor":!1,"uc-inactive_to_editor":!0}),this.ref["frame-el"].toggleThumbs(!1),this.addEventListener("transitionend",this._reset,{once:!0}),(r=this._observer)==null||r.disconnect())}_transitionToCrop(){let e=this._getCropDimensions(),r=Math.min(this.offsetWidth,e[0])/this.$["*cropBox"].width,s=Math.min(this.offsetHeight,e[1])/this.$["*cropBox"].height,o=Math.min(r,s),n=this.$["*cropBox"].x+this.$["*cropBox"].width/2,l=this.$["*cropBox"].y+this.$["*cropBox"].height/2;this.style.transform=`scale(${o}) translate(${(this.offsetWidth/2-n)/o}px, ${(this.offsetHeight/2-l)/o}px)`,this.style.transformOrigin=`${n}px ${l}px`}_transitionToImage(){let e=this.$["*cropBox"].x+this.$["*cropBox"].width/2,r=this.$["*cropBox"].y+this.$["*cropBox"].height/2;this.style.transform="scale(1)",this.style.transformOrigin=`${e}px ${r}px`}_reset(){this._isActive||(this.$.image=null)}async _waitForImage(e,r){var u;let s=this.offsetWidth;r={...r,crop:void 0,rotate:void 0,flip:void 0,mirror:void 0};let o=await this.proxyUrl(ae(e,s,r)),{promise:n,cancel:l,image:a}=_e(o),c=this._handleImageLoading(o);return a.addEventListener("load",c,{once:!0}),a.addEventListener("error",c,{once:!0}),(u=this._cancelPreload)==null||u.call(this),this._cancelPreload=l,n.then(()=>a).catch(h=>(console.error("Failed to load image",{error:h}),this.$["*networkProblems"]=!0,Promise.resolve(a)))}_handleImageLoading(e){let r="crop",s=this.$["*loadingOperations"];return s.get(r)||s.set(r,new Map),s.get(r).get(e)||(s.set(r,s.get(r).set(e,!0)),this.$["*loadingOperations"]=s),()=>{var o;(o=s==null?void 0:s.get(r))!=null&&o.has(e)&&(s.get(r).delete(e),this.$["*loadingOperations"]=s)}}initCallback(){super.initCallback(),this.sub("*imageBox",()=>{this._draw()}),this.sub("*cropBox",()=>{this.$.image&&this._commitDebounced()}),this.sub("*cropPresetList",()=>{this._alignCrop()}),setTimeout(()=>{this.sub("*networkProblems",e=>{e||this._isActive&&this.activate(this._imageSize,{fromViewer:!1})})},0)}destroyCallback(){var e;super.destroyCallback(),(e=this._observer)==null||e.disconnect()}};De.template=`<canvas class="uc-canvas" ref="canvas-el"></canvas><uc-crop-frame ref="frame-el"></uc-crop-frame>`;function ot(i,t,e){let r=Array(e);e--;for(let s=e;s>=0;s--)r[s]=Math.ceil((s*t+(e-s)*i)/e);return r}function kr(i){return i.reduce((t,e,r)=>r<i.length-1?[...t,[e,i[r+1]]]:t,[])}function Lr(i,t,e){let r=kr(i).find(([s,o])=>s<=t&&t<=o);return i.map(s=>{let o=Math.abs(r[0]-r[1]),n=Math.abs(t-r[0])/o;return r[0]===s?t>e?1:1-n:r[1]===s?t>=e?n:1:0})}function Ir(i,t){return i.map((e,r)=>e<t?i.length-r:r)}function mi(i,t){let e=R[i].keypointsNumber,{range:r,zero:s}=R[i];return[...new Set([...ot(r[0],s,e+1),...ot(s,r[1],e+1),s,t])].sort((o,n)=>o-n)}var nt=class extends b{constructor(){super(),this._isActive=!1,this._hidden=!0,this._addKeypointDebounced=C(this._addKeypoint.bind(this),600),this.classList.add("uc-inactive_to_cropper")}_handleImageLoading(t){let e=this._operation,r=this.$["*loadingOperations"];return r.get(e)||r.set(e,new Map),r.get(e).get(t)||(r.set(e,r.get(e).set(t,!0)),this.$["*loadingOperations"]=r),()=>{var s;(s=r==null?void 0:r.get(e))!=null&&s.has(t)&&(r.get(e).delete(t),this.$["*loadingOperations"]=r)}}_flush(){window.cancelAnimationFrame(this._raf),this._raf=window.requestAnimationFrame(()=>{for(let t of this._keypoints){let{image:e}=t;e&&(e.style.opacity=t.opacity.toString(),e.style.zIndex=t.zIndex.toString())}})}async _imageSrc({url:t=this._url,filter:e=this._filter,operation:r,value:s}={}){let o={...this._transformations};r&&(o[r]=e?{name:e,amount:s}:s);let n=this.offsetWidth;return await this.proxyUrl(ae(t,n,o))}async _constructKeypoint(t,e){return{src:await this._imageSrc({operation:t,value:e}),image:null,opacity:0,zIndex:0,value:e}}_isSame(t,e){return this._operation===t&&this._filter===e}async _addKeypoint(t,e,r){let s=()=>!this._isSame(t,e)||this._value!==r||!!this._keypoints.find(a=>a.value===r);if(s())return;let o=await this._constructKeypoint(t,r),n=new Image;n.src=o.src;let l=this._handleImageLoading(o.src);n.addEventListener("load",l,{once:!0}),n.addEventListener("error",l,{once:!0}),o.image=n,n.classList.add("uc-fader-image"),n.addEventListener("load",()=>{if(s())return;let a=this._keypoints,c=a.findIndex(h=>h.value>r),u=c<a.length?a[c].image:null;!this._container||u&&!this._container.contains(u)||(a.splice(c,0,o),this._container.insertBefore(n,u),this._update(t,r))},{once:!0}),n.addEventListener("error",()=>{this.$["*networkProblems"]=!0},{once:!0})}set(t){t=typeof t=="string"?parseInt(t,10):t,this._update(this._operation,t),this._addKeypointDebounced(this._operation,this._filter,t)}_update(t,e){this._operation=t,this._value=e;let{zero:r}=R[t],s=this._keypoints.map(l=>l.value),o=Lr(s,e,r),n=Ir(s,r);for(let[l,a]of Object.entries(this._keypoints))a.opacity=o[l],a.zIndex=n[l];this._flush()}_createPreviewImage(){let t=new Image;return t.classList.add("uc-fader-image","uc-fader-image--preview"),t.style.opacity="0",t}async _initNodes(){let t=document.createDocumentFragment();this._previewImage=this._previewImage||this._createPreviewImage(),!this.contains(this._previewImage)&&t.appendChild(this._previewImage);let e=document.createElement("div");t.appendChild(e);let r=this._keypoints.map(c=>c.src),{images:s,promise:o,cancel:n}=ge(r);s.forEach(c=>{let u=this._handleImageLoading(c.src);c.addEventListener("load",u),c.addEventListener("error",u)}),this._cancelLastImages=()=>{n(),this._cancelLastImages=void 0};let l=this._operation,a=this._filter;await o,this._isActive&&this._isSame(l,a)&&(this._container&&this._container.remove(),this._container=e,this._keypoints.forEach((c,u)=>{let h=s[u];h.classList.add("uc-fader-image"),c.image=h,this._container.appendChild(h)}),this.appendChild(t),this._flush())}async setTransformations(t){if(this._transformations=t,this._previewImage){let e=await this._imageSrc(),r=this._handleImageLoading(e);this._previewImage.src=e,this._previewImage.addEventListener("load",r,{once:!0}),this._previewImage.addEventListener("error",r,{once:!0}),this._previewImage.style.opacity="1",this._previewImage.addEventListener("error",()=>{this.$["*networkProblems"]=!0},{once:!0})}}async preload({url:t,filter:e,operation:r,value:s}){this._cancelBatchPreload&&this._cancelBatchPreload();let o=mi(r,s),n=await Promise.all(o.map(a=>this._imageSrc({url:t,filter:e,operation:r,value:a}))),{cancel:l}=ge(n);this._cancelBatchPreload=l}_setOriginalSrc(t){let e=this._previewImage||this._createPreviewImage();if(!this.contains(e)&&this.appendChild(e),this._previewImage=e,e.src===t){e.style.opacity="1",e.style.transform="scale(1)",this.className=E({"uc-active_from_viewer":this._fromViewer,"uc-active_from_cropper":!this._fromViewer,"uc-inactive_to_cropper":!1});return}e.style.opacity="0";let r=this._handleImageLoading(t);e.addEventListener("error",r,{once:!0}),e.src=t,e.addEventListener("load",()=>{r(),e&&(e.style.opacity="1",e.style.transform="scale(1)",this.className=E({"uc-active_from_viewer":this._fromViewer,"uc-active_from_cropper":!this._fromViewer,"uc-inactive_to_cropper":!1}))},{once:!0}),e.addEventListener("error",()=>{this.$["*networkProblems"]=!0},{once:!0})}async activate({url:t,operation:e,value:r,filter:s,fromViewer:o}){if(this._isActive=!0,this._hidden=!1,this._url=t,this._operation=e||"initial",this._value=r,this._filter=s,this._fromViewer=o,typeof r!="number"&&!s){let l=await this._imageSrc({operation:e,value:r});this._setOriginalSrc(l),this._container&&this._container.remove();return}this._keypoints=await Promise.all(mi(e,r).map(l=>this._constructKeypoint(e,l))),this._update(e,r),this._initNodes()}deactivate({hide:t=!0}={}){this._isActive=!1,this._cancelLastImages&&this._cancelLastImages(),this._cancelBatchPreload&&this._cancelBatchPreload(),t&&!this._hidden?(this._hidden=!0,this._previewImage&&(this._previewImage.style.transform="scale(1)"),this.className=E({"uc-active_from_viewer":!1,"uc-active_from_cropper":!1,"uc-inactive_to_cropper":!0}),this.addEventListener("transitionend",()=>{this._container&&this._container.remove()},{once:!0})):this._container&&this._container.remove()}};var Mr=1,Ue=class extends b{initCallback(){super.initCallback(),this.addEventListener("wheel",t=>{t.preventDefault();let{deltaY:e,deltaX:r}=t;Math.abs(r)>Mr?this.scrollLeft+=r:this.scrollLeft+=e},{passive:!1}),this.addEventListener("scroll",()=>{},{passive:!0})}};Ue.template=" <slot></slot> ";function Pr(i){return`<uc-presence-toggle class="uc-tab-toggle" set="visible: presence.tabToggle.${i}; styles: presence.tabToggleStyles;" ><uc-btn-ui theme="tab" ref="tab-toggle-${i}" data-id="${i}" icon="${i}" set="onclick: on.clickTab; aria-role:tab_role; aria-controls:tab_${i}; title-prop: a11y-editor-tab-${i}" ></uc-btn-ui></uc-presence-toggle>`}function Rr(i){return`<uc-presence-toggle id="tab_${i}" class="uc-tab-content" set="visible: presence.tabContent.${i}; styles: presence.tabContentStyles" ><uc-editor-scroller hidden-scrollbar><div class="uc-controls-list_align"><div role="listbox" aria-orientation="horizontal" class="uc-controls-list_inner" ref="controls-list-${i}" ></div></div></uc-editor-scroller></uc-presence-toggle>`}var Fe=class extends b{constructor(){super();f(this,"_updateInfoTooltip",C(()=>{var n,l;let e=this.$["*editorTransformations"],r=this.$["*currentOperation"],s="",o=!1;if(this.$["*tabId"]===y.FILTERS)if(o=!0,this.$["*currentFilter"]&&((n=e==null?void 0:e.filter)==null?void 0:n.name)===this.$["*currentFilter"]){let a=((l=e==null?void 0:e.filter)==null?void 0:l.amount)||100;s=this.$["*currentFilter"]+" "+a}else s=this.l10n(U);else if(this.$["*tabId"]===y.TUNING&&r){o=!0;let a=(e==null?void 0:e[r])||R[r].zero;s=this.l10n(r)+" "+a}o&&(this.$["*operationTooltip"]=s),this.ref["tooltip-el"].classList.toggle("uc-info-tooltip_visible",o)},0));this.init$={...this.init$,"*sliderEl":null,"*loadingOperations":new Map,"*showSlider":!1,"*currentFilter":U,"*currentOperation":null,showLoader:!1,filters:kt,colorOperations:Ot,cropOperations:Lt,"*operationTooltip":null,"presence.mainToolbar":!0,"presence.subToolbar":!1,"presence.tabToggles":!0,"presence.tabContent.crop":!1,"presence.tabContent.tuning":!1,"presence.tabContent.filters":!1,"presence.tabToggle.crop":!0,"presence.tabToggle.tuning":!0,"presence.tabToggle.filters":!0,"presence.subTopToolbarStyles":{hidden:"uc-sub-toolbar--top-hidden",visible:"uc-sub-toolbar--visible"},"presence.subBottomToolbarStyles":{hidden:"uc-sub-toolbar--bottom-hidden",visible:"uc-sub-toolbar--visible"},"presence.tabContentStyles":{hidden:"uc-tab-content--hidden",visible:"uc-tab-content--visible"},"presence.tabToggleStyles":{hidden:"uc-tab-toggle--hidden",visible:"uc-tab-toggle--visible"},"presence.tabTogglesStyles":{hidden:"uc-tab-toggles--hidden",visible:"uc-tab-toggles--visible"},"on.cancel":()=>{var e;(e=this._cancelPreload)==null||e.call(this),this.$["*on.cancel"]()},"on.apply":()=>{this.$["*on.apply"](this.$["*editorTransformations"])},"on.applySlider":()=>{this.ref["slider-el"].apply(),this._onSliderClose()},"on.cancelSlider":()=>{this.ref["slider-el"].cancel(),this._onSliderClose()},"on.clickTab":e=>{let r=e.currentTarget.getAttribute("data-id");r&&this._activateTab(r,{fromViewer:!1})},tab_role:"tab",[`tab_${y.TUNING}`]:`tab_${y.TUNING}`,[`tab_${y.CROP}`]:`tab_${y.CROP}`,[`tab_${y.FILTERS}`]:`tab_${y.FILTERS}`,cancel:"cancel",apply:"apply","a11y-editor-tab-filters":"a11y-editor-tab-filters","a11y-editor-tab-tuning":"a11y-editor-tab-tuning","a11y-editor-tab-crop":"a11y-editor-tab-crop"},this._debouncedShowLoader=C(this._showLoader.bind(this),500)}_onSliderClose(){this.$["*showSlider"]=!1,this.$["*tabId"]===y.TUNING&&this.ref["tooltip-el"].classList.toggle("uc-info-tooltip_visible",!1)}_createOperationControl(e){let r=new be;return r.operation=e,r}_createFilterControl(e){let r=new le;return r.filter=e,r}_createToggleControl(e){let r=new pe;return r.operation=e,r}_renderControlsList(e){let r=this.ref[`controls-list-${e}`],s=document.createDocumentFragment();e===y.CROP?this.$.cropOperations.forEach(o=>{let n=this._createToggleControl(o);s.appendChild(n)}):e===y.FILTERS?[U,...this.$.filters].forEach(o=>{let n=this._createFilterControl(o);s.appendChild(n)}):e===y.TUNING&&this.$.colorOperations.forEach(o=>{let n=this._createOperationControl(o);s.appendChild(n)}),[...s.children].forEach((o,n)=>{n===s.childNodes.length-1&&o.classList.add("uc-controls-list_last-item")}),r.innerHTML="",r.appendChild(s)}_activateTab(e,{fromViewer:r}){this.$["*tabId"]=e,e===y.CROP?(this.$["*faderEl"].deactivate(),this.$["*cropperEl"].activate(this.$["*imageSize"],{fromViewer:r})):(this.$["*faderEl"].activate({url:this.$["*originalUrl"],fromViewer:r}),this.$["*cropperEl"].deactivate());for(let s of $){let o=s===e,n=this.ref[`tab-toggle-${s}`];n.active=o,o?(this._renderControlsList(e),this._syncTabIndicator()):this._unmountTabControls(s),this.$[`presence.tabContent.${s}`]=o}}_unmountTabControls(e){let r=this.ref[`controls-list-${e}`];r&&(r.innerHTML="")}_syncTabIndicator(){let e=this.ref[`tab-toggle-${this.$["*tabId"]}`],r=this.ref["tabs-indicator"];r.style.transform=`translateX(${e.offsetLeft}px)`}async _preloadEditedImage(){var e;if(this.$["*imgContainerEl"]&&this.$["*originalUrl"]){let r=this.$["*imgContainerEl"].offsetWidth,s=await this.proxyUrl(ae(this.$["*originalUrl"],r,this.$["*editorTransformations"]));(e=this._cancelPreload)==null||e.call(this);let{cancel:o}=ge([s]);this._cancelPreload=()=>{o(),this._cancelPreload=void 0}}}_showLoader(e){this.$.showLoader=e}initCallback(){super.initCallback(),this.$["*sliderEl"]=this.ref["slider-el"],this.sub("*imageSize",e=>{e&&setTimeout(()=>{this._activateTab(this.$["*tabId"],{fromViewer:!0})},0)}),this.sub("*editorTransformations",e=>{var s;let r=(s=e==null?void 0:e.filter)==null?void 0:s.name;this.$["*currentFilter"]!==r&&(this.$["*currentFilter"]=r)}),this.sub("*currentFilter",()=>{this._updateInfoTooltip()}),this.sub("*currentOperation",()=>{this._updateInfoTooltip()}),this.sub("*tabId",()=>{this._updateInfoTooltip()}),this.sub("*originalUrl",()=>{this.$["*faderEl"]&&this.$["*faderEl"].deactivate()}),this.sub("*editorTransformations",e=>{this._preloadEditedImage(),this.$["*faderEl"]&&this.$["*faderEl"].setTransformations(e)}),this.sub("*loadingOperations",e=>{let r=!1;for(let[,s]of e.entries()){if(r)break;for(let[,o]of s.entries())if(o){r=!0;break}}this._debouncedShowLoader(r)}),this.sub("*showSlider",e=>{this.$["presence.subToolbar"]=e,this.$["presence.mainToolbar"]=!e}),this.sub("*tabList",e=>{this.$["presence.tabToggles"]=e.length>1;for(let r of $){this.$[`presence.tabToggle.${r}`]=e.includes(r);let s=this.ref[`tab-toggle-${r}`];s.style.gridColumn=e.indexOf(r)+1}e.includes(this.$["*tabId"])||this._activateTab(e[0],{fromViewer:!1})}),this._updateInfoTooltip()}destroyCallback(){this.$["*showSlider"]=!1}};Fe.template=`<uc-line-loader-ui set="active: showLoader"></uc-line-loader-ui><div class="uc-info-tooltip_container"><div class="uc-info-tooltip_wrapper"><div ref="tooltip-el" class="uc-info-tooltip uc-info-tooltip_hidden">{{*operationTooltip}}</div></div></div><div class="uc-toolbar-container"><uc-presence-toggle role="tablist" class="uc-sub-toolbar" set="visible: presence.mainToolbar; styles: presence.subTopToolbarStyles" ><div class="uc-tab-content-row">${$.map(Rr).join("")}</div><div class="uc-controls-row"><uc-presence-toggle class="uc-tab-toggles" set="visible: presence.tabToggles; styles: presence.tabTogglesStyles" ><div ref="tabs-indicator" class="uc-tab-toggles_indicator"></div> ${$.map(Pr).join("")} </uc-presence-toggle><uc-btn-ui style="order: -1" theme="secondary-icon" icon="closeMax" set="onclick: on.cancel; title-prop:cancel"></uc-btn-ui><uc-btn-ui theme="primary-icon" icon="done" set="onclick: on.apply; title-prop:apply"></uc-btn-ui></div></uc-presence-toggle><uc-presence-toggle class="uc-sub-toolbar" set="visible: presence.subToolbar; styles: presence.subBottomToolbarStyles" ><div class="uc-slider"><uc-editor-slider ref="slider-el"></uc-editor-slider></div><div class="uc-controls-row"><uc-btn-ui theme="secondary" set="onclick: on.cancelSlider" l10n="@text:cancel"></uc-btn-ui><uc-btn-ui theme="primary" set="onclick: on.applySlider" l10n="@text:apply"></uc-btn-ui></div></uc-presence-toggle></div>`;var ye=class extends b{constructor(){super(),this._iconReversed=!1,this._iconSingle=!1,this._iconHidden=!1,this.init$={...this.init$,text:"",icon:"",iconCss:this._iconCss(),theme:null,"aria-role":"","aria-controls":"","title-prop":""},this.defineAccessor("active",t=>{t?this.setAttribute("active",""):this.removeAttribute("active")})}_iconCss(){return E("uc-icon",{"uc-icon_left":!this._iconReversed,"uc-icon_right":this._iconReversed,"uc-icon_hidden":this._iconHidden,"uc-icon_single":this._iconSingle})}initCallback(){super.initCallback(),this.sub("icon",t=>{this._iconSingle=!this.$.text,this._iconHidden=!t,this.$.iconCss=this._iconCss()}),this.sub("theme",t=>{t!=="custom"&&(this.className=`uc-${t}`)}),this.sub("text",t=>{this._iconSingle=!1}),this.hasAttribute("theme")||this.setAttribute("theme","default"),this.defineAccessor("aria-role",t=>{this.$["aria-role"]=t||""}),this.defineAccessor("aria-controls",t=>{this.$["aria-controls"]=t||""}),this.defineAccessor("title-prop",t=>{this.$["title-prop"]=t||""})}set reverse(t){this.hasAttribute("reverse")?(this.style.flexDirection="row-reverse",this._iconReversed=!0):(this._iconReversed=!1,this.style.flexDirection=null)}};ye.bindAttributes({text:"text",icon:"icon",reverse:"reverse",theme:"theme"});ye.template=`<button type="button" set="@role:aria-role; @aria-controls: aria-controls; @aria-label:title-prop" l10n="@title:title-prop;" ><uc-icon set="className: iconCss; @name: icon; @hidden: !icon"></uc-icon><div class="uc-text">{{text}}</div></button>`;var ze=class extends b{constructor(){super(),this._active=!1,this._handleTransitionEndRight=()=>{let t=this.ref["line-el"];t.style.transition="initial",t.style.opacity="0",t.style.transform="translateX(-101%)",this._active&&this._start()}}initCallback(){super.initCallback(),this.defineAccessor("active",t=>{typeof t=="boolean"&&(t?this._start():this._stop())})}_start(){this._active=!0;let{width:t}=this.getBoundingClientRect(),e=this.ref["line-el"];e.style.transition="transform 1s",e.style.opacity="1",e.style.transform=`translateX(${t}px)`,e.addEventListener("transitionend",this._handleTransitionEndRight,{once:!0})}_stop(){this._active=!1}};ze.template=`<div class="uc-inner"><div class="uc-line" ref="line-el"></div></div>`;var Ve={transition:"uc-transition",visible:"uc-visible",hidden:"uc-hidden"},je=class extends b{constructor(){super(),this._visible=!1,this._visibleStyle=Ve.visible,this._hiddenStyle=Ve.hidden,this._externalTransitions=!1,this.defineAccessor("styles",t=>{t&&(this._externalTransitions=!0,this._visibleStyle=t.visible,this._hiddenStyle=t.hidden)}),this.defineAccessor("visible",t=>{typeof t=="boolean"&&(this._visible=t,this._handleVisible())})}_handleVisible(){this.style.visibility=this._visible?"inherit":"hidden",Yt(this,{[Ve.transition]:!this._externalTransitions,[this._visibleStyle]:this._visible,[this._hiddenStyle]:!this._visible}),this.setAttribute("aria-hidden",this._visible?"false":"true")}initCallback(){super.initCallback(),this.classList.toggle("uc-initial",!0),this._externalTransitions||this.classList.add(Ve.transition),this._handleVisible(),setTimeout(()=>{this.classList.toggle("uc-initial",!1)},0)}};je.template="<slot></slot> ";var Be=class extends b{constructor(){super();f(this,"init$",{...this.init$,disabled:!1,min:0,max:100,onInput:null,onChange:null,defaultValue:null,"on.sliderInput":()=>{let e=parseInt(this.ref["input-el"].value,10);this._updateValue(e),this.$.onInput&&this.$.onInput(e)},"on.sliderChange":()=>{let e=parseInt(this.ref["input-el"].value,10);this.$.onChange&&this.$.onChange(e)}});this.setAttribute("with-effects","")}initCallback(){super.initCallback(),this.defineAccessor("disabled",r=>{this.$.disabled=r}),this.defineAccessor("min",r=>{this.$.min=r}),this.defineAccessor("max",r=>{this.$.max=r}),this.defineAccessor("defaultValue",r=>{this.$.defaultValue=r,this.ref["input-el"].value=r,this._updateValue(r)}),this.defineAccessor("zero",r=>{this._zero=r}),this.defineAccessor("onInput",r=>{r&&(this.$.onInput=r)}),this.defineAccessor("onChange",r=>{r&&(this.$.onChange=r)}),this._updateSteps(),this._observer=new ResizeObserver(()=>{this._updateSteps();let r=parseInt(this.ref["input-el"].value,10);this._updateValue(r)}),this._observer.observe(this),this._thumbSize=parseInt(window.getComputedStyle(this).getPropertyValue("--l-thumb-size"),10),setTimeout(()=>{let r=parseInt(this.ref["input-el"].value,10);this._updateValue(r)},0),this.sub("disabled",r=>{let s=this.ref["input-el"];r?s.setAttribute("disabled","disabled"):s.removeAttribute("disabled")});let e=this.ref["input-el"];e.addEventListener("focus",()=>{this.style.setProperty("--color-effect","var(--hover-color-rgb)")}),e.addEventListener("blur",()=>{this.style.setProperty("--color-effect","var(--idle-color-rgb)")})}_updateValue(e){this._updateZeroDot(e);let{width:r}=this.getBoundingClientRect(),n=100/(this.$.max-this.$.min)*(e-this.$.min)*(r-this._thumbSize)/100;window.requestAnimationFrame(()=>{this.ref["thumb-el"].style.transform=`translateX(${n}px)`})}_updateZeroDot(e){if(!this._zeroDotEl)return;e===this._zero?this._zeroDotEl.style.opacity="0":this._zeroDotEl.style.opacity="1";let{width:r}=this.getBoundingClientRect(),n=100/(this.$.max-this.$.min)*(this._zero-this.$.min)*(r-this._thumbSize)/100;window.requestAnimationFrame(()=>{this._zeroDotEl.style.transform=`translateX(${n}px)`})}_updateSteps(){let r=this.ref["steps-el"],{width:s}=r.getBoundingClientRect(),o=Math.ceil(s/2),n=Math.ceil(o/15)-2;if(this._stepsCount===n)return;let l=document.createDocumentFragment(),a=document.createElement("div"),c=document.createElement("div");a.className="uc-minor-step",c.className="uc-border-step",l.appendChild(c);for(let h=0;h<n;h++)l.appendChild(a.cloneNode());l.appendChild(c.cloneNode());for(let h=0;h<n;h++)l.appendChild(a.cloneNode());l.appendChild(c.cloneNode());let u=document.createElement("div");u.className="uc-zero-dot",l.appendChild(u),this._zeroDotEl=u,r.innerHTML="",r.appendChild(l),this._stepsCount=n}destroyCallback(){var e;super.destroyCallback(),(e=this._observer)==null||e.disconnect()}};Be.template=`<div class="uc-steps" ref="steps-el"></div><div ref="thumb-el" class="uc-thumb"></div><input class="uc-input" type="range" ref="input-el" set="oninput: on.sliderInput; onchange: on.sliderChange; @min: min; @max: max; @value: defaultValue;" />`;var ve=class ve extends K{initCallback(){var t;super.initCallback(),(t=this.a11y)==null||t.registerBlock(this)}};f(ve,"styleAttrs",[...pt(ve,ve,"styleAttrs"),"uc-wgt-common"]);var _i=ve;var we=class extends b{constructor(){super(),this.init$={...this.init$,name:"",href:""}}initCallback(){super.initCallback(),this.sub("name",t=>{if(!t)return;let e=`#uc-icon-${t}`;this.subConfigValue("iconHrefResolver",r=>{if(r){let s=r(t);e=s!=null?s:e}this.$.href=e})}),this.setAttribute("aria-hidden","true")}};we.template=`<svg ref="svg" xmlns="http://www.w3.org/2000/svg"><use set="@href: href;"></use></svg>`;we.bindAttributes({name:"name"});function Nr(i){for(let t in i){let e=[...t].reduce((r,s)=>(s.toUpperCase()===s&&(s="-"+s.toLowerCase()),r+=s),"");e.startsWith("-")&&(e=e.replace("-","")),e.startsWith("uc-")||(e="uc-"+e),i[t].reg&&i[t].reg(e)}}var He=i=>{var t;return(t=i.match(/[A-Z]{2,}(?=[A-Z][a-z]+[0-9]*|\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g))==null?void 0:t.map(e=>e.toLowerCase()).join("-")};var lt=Object.freeze({PHOTO:"photo",VIDEO:"video"}),jl=Object.freeze({IDLE:"idle",SHOT:"shot",PLAY:"play",PAUSE:"pause",RESUME:"resume",STOP:"stop",RETAKE:"retake",ACCEPT:"accept"});var v=i=>String(i),O=i=>{let t=Number(i);if(Number.isNaN(t))throw new Error(`Invalid number: "${i}"`);return t},w=i=>{if(typeof i=="undefined"||i===null)return!1;if(typeof i=="boolean")return i;if(i==="true"||i==="")return!0;if(i==="false")return!1;throw new Error(`Invalid boolean: "${i}"`)},gi=i=>i==="auto"?i:w(i),bi=i=>{let t=v(i);if(t!=="user"&&t!=="environment"&&t!=="")throw new Error(`Invalid value: "${t}"`);return t},yi=i=>{let t=v(i);if(!Object.values(lt).includes(t))throw new Error(`Invalid value: "${t}"`);return t},vi=i=>{let t=v(i),e=Y(t);if(e.some(r=>!Object.values(lt).includes(r)))throw new Error(`Invalid value: "${JSON.stringify(e)}"`);return t},wi=i=>{if(typeof i=="object"&&!Array.isArray(i)||typeof i=="function")return i;throw new Error("Invalid metadata value. Must be an object or function.")},at=i=>{if(typeof i=="object")return i;throw new Error("Invalid value. Must be an object.")},Xe=i=>{if(typeof i=="function")return i;throw new Error("Invalid value. Must be a function.")},ct=i=>{if(Array.isArray(i))return i;throw new Error("Must be an array.")},xi=i=>{let t=v(i);if(["grid","list"].includes(t))return t;throw new Error(`Invalid value: "${t}"`)};var Dr={pubkey:v,multiple:w,multipleMin:O,multipleMax:O,confirmUpload:w,imgOnly:w,accept:v,externalSourcesPreferredTypes:v,externalSourcesEmbedCss:v,store:gi,cameraMirror:w,cameraCapture:bi,sourceList:v,topLevelOrigin:v,maxLocalFileSizeBytes:O,thumbSize:O,showEmptyList:w,useLocalImageEditor:w,useCloudImageEditor:w,cloudImageEditorTabs:v,removeCopyright:w,cropPreset:v,imageShrink:v,modalScrollLock:w,modalBackdropStrokes:w,sourceListWrap:w,remoteTabSessionKey:v,cdnCname:v,baseUrl:v,socialBaseUrl:v,secureSignature:v,secureExpire:v,secureDeliveryProxy:v,retryThrottledRequestMaxTimes:O,retryNetworkErrorMaxTimes:O,multipartMinFileSize:O,multipartChunkSize:O,maxConcurrentRequests:O,multipartMaxConcurrentRequests:O,multipartMaxAttempts:O,checkForUrlDuplicates:w,saveUrlForRecurrentUploads:w,groupOutput:w,userAgentIntegration:v,debug:w,localeName:v,metadata:wi,secureUploadsExpireThreshold:O,localeDefinitionOverride:at,secureUploadsSignatureResolver:Xe,secureDeliveryProxyUrlResolver:Xe,iconHrefResolver:Xe,fileValidators:ct,collectionValidators:ct,cameraModes:vi,defaultCameraMode:yi,enableAudioRecording:w,enableVideoRecording:w,mediaRecorderOptions:at,maxVideoRecordingDuration:O,filesViewMode:xi,gridShowFileNames:w,cloudImageEditorAutoOpen:w,cloudImageEditorMaskHref:v,testMode:w},Ei=(i,t)=>{if(!(typeof t=="undefined"||t===null))try{return Dr[i](t)}catch(e){return console.error(`Invalid value for config key "${i}".`,e),M[i]}};var Ci=new Set;function Ti(i){Ci.has(i)||(Ci.add(i),console.warn(i))}var Ur=[{test:i=>i.accept&&!!i.imgOnly,message:"There could be a mistake.\nBoth `accept` and `imgOnly` parameters are set.\nThe value of `accept` will be concatenated with the internal image mime types list."},{test:i=>i.enableVideoRecording!==null,message:"The `enableVideoRecording` parameter is deprecated and will be removed in the next major release.\nPlease use the `cameraModes` parameter instead."},{test:i=>i.defaultCameraMode!==null,message:"The `defaultCameraMode` parameter is deprecated and will be removed in the next major release.\nPlease use the `cameraModes` parameter instead."}],Ai=C(i=>{for(let{test:t,message:e}of Ur)t(i)&&Ti(e)},0);var Si=({key:i,value:t,setValue:e,getValue:r})=>{if(i==="enableVideoRecording"&&t!==null){let s=Y(r("cameraModes"));t&&!s.includes("video")?s=s.concat("video"):t||(s=s.filter(o=>o!=="video")),e("cameraModes",Z(s))}if(i==="defaultCameraMode"&&t!==null){let s=Y(r("cameraModes"));s=s.sort((o,n)=>o===t?-1:n===t?1:0),e("cameraModes",Z(s))}};var ht=[...new Set(["debug",...Object.keys(M)])],Fr=["metadata","localeDefinitionOverride","secureUploadsSignatureResolver","secureDeliveryProxyUrlResolver","iconHrefResolver","fileValidators","collectionValidators","mediaRecorderOptions"],zr=i=>Fr.includes(i),ce=ht.filter(i=>!zr(i)),Vr={...Object.fromEntries(ce.map(i=>[He(i),i])),...Object.fromEntries(ce.map(i=>[i.toLowerCase(),i]))},jr={...Object.fromEntries(ce.map(i=>[He(i),T(i)])),...Object.fromEntries(ce.map(i=>[i.toLowerCase(),T(i)]))},$i=i=>"__"+i,xe=class extends b{constructor(){super();f(this,"requireCtxName",!0);this.init$={...this.init$,...Object.fromEntries(Object.entries(M).map(([e,r])=>[T(e),r]))}}_flushValueToAttribute(e,r){if(ce.includes(e)){let s=[...new Set([He(e),e.toLowerCase()])];for(let o of s)typeof r=="undefined"||r===null?this.removeAttribute(o):this.getAttribute(o)!==r.toString()&&this.setAttribute(o,r.toString())}}_flushValueToState(e,r){this.$[T(e)]!==r&&(typeof r=="undefined"||r===null?this.$[T(e)]=M[e]:this.$[T(e)]=r)}_setValue(e,r){let s=this,o=Ei(e,r),n=$i(e);s[n]!==o&&(this._assertSameValueDifferentReference(e,s[n],o),s[n]=o,this._flushValueToAttribute(e,o),this._flushValueToState(e,o),this.debugPrint(`[uc-config] "${e}"`,o),Ai(this.cfg),Si({key:e,value:o!=null?o:null,setValue:this._setValue.bind(this),getValue:this._getValue.bind(this)}))}_getValue(e){var o;let r=this,s=$i(e);return(o=r[s])!=null?o:this.$[T(e)]}_assertSameValueDifferentReference(e,r,s){this.cfg.debug&&s!==r&&typeof s=="object"&&typeof r=="object"&&JSON.stringify(s)===JSON.stringify(r)&&(console.warn(`[uc-config] Option "${e}" value is the same as the previous one but the reference is different`),console.warn("[uc-config] You should avoid changing the reference of the object to prevent unnecessary calculations"),console.warn(`[uc-config] "${e}" previous value:`,r),console.warn(`[uc-config] "${e}" new value:`,s))}initCallback(){var r;super.initCallback();let e=this;for(let s of ce)this.sub(T(s),o=>{this._setValue(s,o)},!1);for(let s of ht){let o=(r=e[s])!=null?r:this.$[T(s)];o!==M[s]&&this._setValue(s,o),Object.defineProperty(this,s,{set:n=>{this._setValue(s,n)},get:()=>this._getValue(s)})}}attributeChangedCallback(e,r,s){if(r===s)return;let o=this,n=Vr[e];o[n]=s}};xe.bindAttributes(jr);for(let i of ht)xe.prototype[i]=void 0;var Br=xe;export{ye as BtnUi,_i as CloudImageEditor,K as CloudImageEditorBlock,Br as Config,Re as CropFrame,pe as EditorCropButtonControl,le as EditorFilterControl,De as EditorImageCropper,nt as EditorImageFader,be as EditorOperationControl,Ue as EditorScroller,Ne as EditorSlider,Fe as EditorToolbar,we as Icon,ze as LineLoaderUi,je as PresenceToggle,Be as SliderUi,Nr as defineComponents};